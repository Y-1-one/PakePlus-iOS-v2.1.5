import{c as _,r as i,h as vt,g as Is,i as Nt,k as yt,a as Es,j as e,l as Ct,t as n,m as _t,R as D,n as Ds,o as Ps,q as ae,B as As,f as St,u as zt,v as It,S as le,w as Et,G as Dt,U as Pt,x as Ms,Q as Ts,X as f,y as Os,z as Rs,T as At,P as Mt,D as Tt,F as Ls,M as Ot,b as Rt,E as Lt,H as re,I as L,J as U,e as Qt,K as $,d as Ut,s as $t,N as Us,O as Gt,V as Ft,p as $s,L as Bt,W as Gs,Y as Fs,Z as Bs,_ as Hs,$ as Js,a0 as Vs}from"./index-L8c2kVrv.js";import{P as ie,b as ne,a as Qs,D as de,L as Ws,S as Oe,Z as Ht,T as Ys,c as Zs,d as Xs,M as qs,C as Ks,e as ea,B as ta,I as sa,F as aa}from"./zap-BqpAjds9.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]],ra=_("command",la);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],na=_("database",ia);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],oa=_("git-commit-horizontal",da);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],xa=_("heart",ca);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Jt=_("key",ha);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Re=_("log-out",ma);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],ga=_("timer",ba);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"m2 8 2 2-2 2 2 2-2 2",key:"sv1b1"}],["path",{d:"m22 8-2 2 2 2-2 2 2 2",key:"101i4y"}],["rect",{width:"8",height:"14",x:"8",y:"5",rx:"1",key:"1oyrl4"}]],pa=_("vibrate",ua),oe="eurasia_growth_engine_v1_secret_salt",Vt="薪火相传，生生不息。愿你带领大家，奔赴更远的星辰大海。",p=({children:G})=>Qt.createPortal(G,document.body),ka=({onThemeChange:G})=>{var ft,jt;const[j,Le]=i.useState(vt()),[s,P]=i.useState(null),[S,Ue]=i.useState(Is()),[F,ce]=i.useState(!1),[xe,$e]=i.useState(""),[he,Ge]=i.useState(""),[Fe,Be]=i.useState(""),[me,He]=i.useState(""),[Je,Ve]=i.useState(""),[be,Qe]=i.useState(""),[B,ge]=i.useState(""),[A,We]=i.useState(!0),[ue,Wt]=i.useState(Nt()),[m,v]=i.useState(Nt()),[z,H]=i.useState("basic"),[d,r]=i.useState(null),[x,C]=i.useState(null),[pe,Ye]=i.useState(""),[fe,Ze]=i.useState(!1),[je,Xe]=i.useState(!1),[we,qe]=i.useState(!1);i.useEffect(()=>{d==="global_edit"&&v(ue)},[d,ue]);const[J,ke]=i.useState(""),[N,V]=i.useState("temp_admin"),[Ke,et]=i.useState(""),[Q,ve]=i.useState(""),[Yt,Zt]=i.useState(0),[Xt,tt]=i.useState(!1),[W,Y]=i.useState(0),[qt,Ne]=i.useState(!1),[ye,Kt]=i.useState(""),[Ce,st]=i.useState(""),[Z,X]=i.useState(""),[I,q]=i.useState(!1),[_e,Se]=i.useState(""),[es,at]=i.useState(""),[lt,ze]=i.useState(""),[rt,Ie]=i.useState("cimbar"),[K,Ee]=i.useState(""),[ts,ee]=i.useState(!1),[E,M]=i.useState("full"),[T,y]=i.useState("upload"),[fa,it]=i.useState(""),[De,nt]=i.useState(""),[dt,Pe]=i.useState(""),[h,O]=i.useState(null),[R,w]=i.useState(null),[ot,Ae]=i.useState(""),Me=i.useRef(null);i.useEffect(()=>{yt(j),G&&G(j.themeMode)},[j]),i.useEffect(()=>{const t=Es();if(P(t),t){$e(t.name),Ge(t.departmentId),Be(t.position),He(t.avatar),Ve(t.birthday||""),Qe(t.college||"人文教育学院");let a=t.organization||"西安欧亚学院人文教育学院学生成长促进会";const l=a.startsWith("西安欧亚学院");We(l),l&&(a=a.replace("西安欧亚学院",""),t.college&&a.startsWith(t.college)&&(a=a.replace(t.college,""))),ge(a)}},[]);const Te=t=>{Le(a=>({...a,themeMode:t})),n("selection")},ss=t=>{Le(a=>({...a,hapticIntensity:t})),yt({...j,hapticIntensity:t}),setTimeout(()=>{t>0&&n("medium")},100)},as=()=>{s!=null&&s.userId&&(navigator.clipboard.writeText(s.userId),n("success"),alert("个人编号已复制"))},ls=async t=>{var l;const a=(l=t.target.files)==null?void 0:l[0];if(a){Ze(!0);try{const o=await Lt(a,300,.7);He(o)}catch{alert("图片处理失败")}finally{Ze(!1)}}},rs=()=>{if(!xe||!he)return;const t=A?`西安欧亚学院${be}${B}`:B,a={...s,name:xe,departmentId:he,position:Fe,avatar:me,birthday:Je,college:be,organization:t,registerDate:(s==null?void 0:s.registerDate)||new Date().toISOString().split("T")[0],identity:(s==null?void 0:s.identity)||"user",userId:s==null?void 0:s.userId};re(a),P(a),ce(!1),n("success")},ct=()=>{n("medium"),r("logout_joke")},is=((ft=S.find(t=>t.id===(s==null?void 0:s.departmentId)))==null?void 0:ft.name)||"未设置",te=t=>{switch(t){case"permanent_admin":return"永久管理员";case"long_term_admin":return"长期管理员";case"temp_admin":return"临时管理员";default:return"普通成员"}},ns=t=>{switch(t){case"permanent_admin":return"bg-amber-100 dark:bg-amber-500/20 text-amber-600 dark:text-amber-400 border-amber-200 dark:border-amber-500/30";case"long_term_admin":return"bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 border-blue-200 dark:border-blue-500/30";case"temp_admin":return"bg-green-100 dark:bg-green-500/20 text-green-600 dark:text-green-400 border-green-200 dark:border-green-500/30";default:return"bg-slate-500/10 text-slate-500 dark:text-slate-400 border-slate-500/20"}},ds=t=>t==="permanent_admin"||t==="long_term_admin"||t==="temp_admin",os=()=>{Us(m),Wt(m),r(null),n("success"),alert("全局配置已更新")},cs=async t=>{var l;const a=(l=t.target.files)==null?void 0:l[0];if(a){Xe(!0);try{const o=await Lt(a,600,.8);v(c=>({...c,contactQrCode:o}))}catch{alert("图片上传失败")}finally{Xe(!1)}}},xt=(t,a=16)=>{const l={size:a};switch(t){case"CalendarPlus":return e.jsx(Vs,{...l});case"ArrowUpRight":return e.jsx(Js,{...l});case"Lightbulb":return e.jsx(Hs,{...l});case"Bug":return e.jsx(Bs,{...l});case"Github":return e.jsx(Fs,{...l});case"Calendar":return e.jsx(St,{...l});case"BookOpen":return e.jsx(Gs,{...l});case"Globe":return e.jsx(Dt,{...l});case"Link":return e.jsx(Bt,{...l});case"FileText":return e.jsx(aa,{...l});case"Monitor":return e.jsx(Ot,{...l});case"Users":return e.jsx(Pt,{...l});case"Image":return e.jsx(sa,{...l});case"Briefcase":return e.jsx(ta,{...l});case"Zap":return e.jsx(Ht,{...l});case"Coffee":return e.jsx(ea,{...l});case"Download":return e.jsx(de,{...l});case"Clock":return e.jsx(Ks,{...l});case"MessageCircle":return e.jsx(qs,{...l});case"Book":return e.jsx(Xs,{...l});case"Cloud":return e.jsx(Zs,{...l});case"Plus":return e.jsx(Rt,{...l});default:return e.jsx(Bt,{...l})}},xs=["CalendarPlus","ArrowUpRight","Lightbulb","Bug","Github","Calendar","BookOpen","Globe","Link","FileText","Monitor","Users","Image","Briefcase","Zap","Coffee","Download","Clock","MessageCircle","Book","Cloud"],hs=({value:t,onChange:a})=>{const[l,o]=i.useState(!1),c=i.useRef(null),[b,k]=i.useState({}),u=g=>{if(g.stopPropagation(),!l&&c.current){const se=c.current.getBoundingClientRect(),_s=se.bottom+window.scrollY+5,Ss=se.left+window.scrollX,zs=window.innerHeight,wt=220;let kt=_s;se.bottom+wt>zs&&(kt=se.top+window.scrollY-wt-5),k({position:"fixed",top:kt,left:Ss,zIndex:99999,width:"260px"})}o(!l)};return i.useEffect(()=>{const g=()=>o(!1);return l&&window.addEventListener("click",g),()=>window.removeEventListener("click",g)},[l]),e.jsxs(e.Fragment,{children:[e.jsxs("button",{ref:c,onClick:u,className:"p-2 border border-slate-200 dark:border-white/10 rounded-lg flex items-center gap-2 bg-white dark:bg-white/5 hover:bg-slate-50 dark:hover:bg-white/10",children:[xt(t),e.jsx("span",{className:"text-xs text-slate-500",children:t})]}),l&&Qt.createPortal(e.jsx("div",{style:b,className:"bg-white dark:bg-gray-800 border border-slate-200 dark:border-white/10 rounded-xl shadow-2xl p-2 grid grid-cols-5 gap-1 animate-fade-in",onClick:g=>g.stopPropagation(),children:xs.map(g=>e.jsx("button",{onClick:()=>{a(g),o(!1)},className:`p-2 rounded-lg flex justify-center hover:bg-slate-100 dark:hover:bg-white/10 ${t===g?"bg-indigo-50 dark:bg-indigo-500/20 text-indigo-600 dark:text-indigo-300":"text-slate-500 dark:text-slate-400"}`,title:g,children:xt(g,18)},g))}),document.body)]})},ht=()=>{if(!x||!x.name)return;let t=[...S];if(x.id==="NEW"){const a=`dept_${Date.now()}`,l={...x,id:a,cards:[],announcements:[]};t.push(l)}else{const a=t.findIndex(l=>l.id===x.id);a!==-1&&(t[a]={...t[a],...x})}$t(t),Ue(t),r("dept_manage"),n("success")},mt=t=>{if(confirm("确定要删除该部门吗？此操作不可逆，且会影响该部门下的所有成员。")){const a=S.filter(l=>l.id!==t);$t(a),Ue(a),n("heavy")}},ms=()=>{ke(""),V("temp_admin"),et(""),ve(""),Ne(!1),r("admin_grant"),n("medium")},bs=async()=>{if(!J||!/^[A-Za-z0-9+/=]{16}$/.test(J)){Ne(!0),n("error"),setTimeout(()=>Ne(!1),500);return}tt(!0),Y(0),n("heavy"),setTimeout(()=>{Y(1),n("light")},1e3),setTimeout(()=>{Y(2),n("medium")},2e3),setTimeout(()=>{Y(3),n("heavy")},3e3),setTimeout(async()=>{ee(!0);const a=Date.now(),l=N==="long_term_admin",o={type:"auth_token",sender_uid:s==null?void 0:s.userId,target_uid:J,role:N,msg:Ke||Vt,iat:a,exp:a+600*1e3,inheriting:l},c=$.HmacSHA256(JSON.stringify(o),oe).toString(),b={...o,sig:c};Se(JSON.stringify(b));try{const k=await Ut(JSON.stringify(b));ve(k),Zt(b.exp),n("success")}catch{alert("生成凭证失败")}finally{ee(!1),tt(!1)}},3500)},bt=()=>{Q&&(at(Q),ze(`eurasia_auth_${N}_${new Date().toISOString().split("T")[0]}.png`),Ie("auth"),r("export_selector"),n("selection"))},gs=()=>{if(s){if(s.identity==="permanent_admin"){alert("永久管理员身份无法降级。");return}if(confirm("确认交接完成？此操作将立即移除您的管理员权限。")){const t={...s,identity:"user"};re(t),P(t),r(null),n("heavy"),alert("卸任成功，感谢您的付出。"),window.location.reload()}}},us=()=>{try{n("selection");const t=Gt(E),a=Ft(t,I?Z:void 0);Se(a),ze(`eurasia_backup_${E}_${new Date().toISOString().split("T")[0]}.json`),Ie("file"),r("export_selector"),n("selection")}catch(t){alert("导出失败"),console.error(t)}},ps=t=>{var o;const a=(o=t.target.files)==null?void 0:o[0];if(!a)return;const l=new FileReader;l.onload=c=>{var b;try{const k=(b=c.target)==null?void 0:b.result;try{const u=JSON.parse(k);if(u.h&&u.t)if(Pe(k),u.e)nt(""),w(null),r("import_file_decrypt");else try{const g=L(k);confirm("导入将覆盖当前所有数据，确定继续吗？")&&(U(g),alert("数据恢复成功，即将刷新页面"),window.location.reload())}catch{alert("数据校验失败 (MD5 Mismatch)")}else confirm("检测到旧版备份格式，导入将覆盖当前所有数据，确定继续吗？")&&(U(u),alert("数据恢复成功，即将刷新页面"),window.location.reload())}catch{alert("文件格式错误")}}catch{alert("读取文件失败")}},l.readAsText(a),Me.current&&(Me.current.value="")},fs=()=>{try{const t=L(dt,De);confirm("密码正确！导入将覆盖当前所有数据，确定继续吗？")&&(U(t),alert("数据恢复成功，即将刷新页面"),window.location.reload())}catch{n("error"),w("密码错误或数据损坏")}},js=async()=>{ee(!0),n("medium");try{const t=Gt(E),a=Ft(t,I?Z:void 0);Se(a);const l=await Ut(a);Ee(l),n("success")}catch(t){alert("生成失败"),console.error(t)}finally{ee(!1)}},ws=()=>{K&&(at(K),ze(`eurasia_${E}_cimbar.png`),Ie("cimbar"),r("export_selector"),n("selection"))},gt=t=>{try{try{const l=JSON.parse(t);if(l.type==="auth_token"){ut(l);return}}catch{}if(Pe(t),n("success"),JSON.parse(t).e)y("decrypt");else try{const l=L(t);O(l),y("confirm")}catch{w("数据完整性校验失败 (MD5 mismatch)"),n("error")}d==="manual_import"&&r("import_cimbar")}catch(a){console.error(a),w("无效的数据格式"),n("error")}},ks=async()=>{try{const t=await navigator.clipboard.readText();if(!t)throw new Error("Empty");gt(t)}catch{Ye(""),r("manual_import"),n("warning")}},vs=t=>{var c;const a=(c=t.target.files)==null?void 0:c[0];if(!a)return;const l=URL.createObjectURL(a);it(l),w(null),qe(!0);const o=new Image;o.onload=async()=>{try{const b=await $s(o);try{const u=JSON.parse(b);if(u.type==="auth_token"){ut(u);return}}catch{}if(Pe(b),n("success"),JSON.parse(b).e)y("decrypt");else try{const u=L(b);O(u),y("confirm")}catch{w("数据完整性校验失败 (MD5 mismatch)"),n("error")}}catch(b){console.error(b),w("无法识别有效的彩色配置码，请确保图片清晰且未经压缩"),n("error")}finally{qe(!1)}},o.src=l},ut=t=>{y("auth_check"),Ae("verifying"),st(""),setTimeout(()=>{const{sig:a,...l}=t,o=$.HmacSHA256(JSON.stringify(l),oe).toString();let c=null;if(a!==o?c="凭证签名无效，可能已被篡改":t.target_uid!==(s==null?void 0:s.userId)?c="个人编号不匹配，无法激活此权限":Date.now()>t.exp?c="凭证已过期，请重新生成":t.role==="long_term_admin"&&((s==null?void 0:s.identity)==="long_term_admin"||(s==null?void 0:s.identity)==="permanent_admin")?c="您已拥有长期管理员或更高身份，无法接受此传承":t.role==="permanent_admin"&&(c="非法操作：永久管理员权限无法通过二维码授予"),c){if(w(c),Ae("error"),n("error"),t.sender_uid&&t.role&&t.role!=="permanent_admin"){const b={s:t.sender_uid,r:"long_term_admin",t:Date.now()},k=$.AES.encrypt(JSON.stringify(b),oe).toString();st(k)}return}O(t),Ae("success"),n("success"),t.inheriting&&setTimeout(()=>{y("legacy_reveal"),n("medium")},1e3)},2e3)},pt=()=>{if(!h||!s)return;const t=h.role,a={...s,identity:t};re(a),P(a),alert(`权限激活成功！当前身份：${te(t)}`),n("heavy"),window.location.reload()},Ns=()=>{try{const t=L(dt,De);O(t),y("confirm"),w(null),n("success")}catch(t){n("error"),t.message==="DECRYPTION_FAILED"?w("密码错误，解密失败"):t.message==="INTEGRITY_CHECK_FAILED"?w("数据校验失败，文件可能已损坏"):w("未知错误")}},ys=()=>{if(h){const a=h.exportVersion===2?h.active:h;if(!a.profile&&!a.todos&&(a.settings||a.globalConfig||a.departments)){if(a.settings){const l=vt();a.settings={...a.settings,darkMode:l.darkMode,hapticIntensity:l.hapticIntensity}}n("heavy"),U(h),alert("全局配置同步成功，个人设置/个人编号不受影响")}else n("heavy"),U(h),alert("数据恢复成功！");window.location.reload()}},Cs=()=>{if(ye)try{const t=$.AES.decrypt(ye,oe),a=JSON.parse(t.toString($.enc.Utf8));if(a.s===(s==null?void 0:s.userId)){if(Date.now()-a.t>36e5){alert("恢复代码已过期");return}const l={...s,identity:a.r};re(l),P(l),r(null),n("success"),alert(`身份恢复成功！欢迎回来，${te(a.r)}`),window.location.reload()}else alert("该代码不属于此账号，无法恢复")}catch{alert("无效的恢复代码")}};return e.jsxs("div",{className:"w-full h-full p-6 md:p-8 overflow-y-auto pb-24 animate-fade-in hide-scrollbar text-slate-800 dark:text-white",children:[e.jsx("style",{children:`
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-5px); }
          75% { transform: translateX(5px); }
        }
        .animate-shake {
          animation: shake 0.3s ease-in-out;
        }
        .legacy-glow {
          text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
      `}),e.jsxs("div",{className:"max-w-[1800px] mx-auto h-full flex flex-col",children:[e.jsxs("div",{className:"flex flex-row items-end justify-between mb-6 gap-4 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-4xl font-bold text-slate-900 dark:text-white tracking-tight text-glow",children:"系统设置"}),e.jsx("p",{className:"text-slate-500 dark:text-white/60 mt-1 text-base",children:"个性化配置与数据管理中心"})]}),e.jsxs("button",{onClick:()=>{r("version_info"),n("light")},className:"glass-card text-indigo-500 dark:text-indigo-300 border-indigo-200 dark:border-indigo-500/30 px-4 py-1.5 rounded-full text-xs font-mono tracking-wide active:scale-95 transition-transform hover:bg-white/50 dark:hover:bg-white/10 flex items-center gap-2 shadow-sm",children:[e.jsx(Ct,{size:12,className:"animate-pulse"})," v2.5.0"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 flex-1 min-h-0",children:[e.jsxs("div",{className:"lg:col-span-4 flex flex-col gap-6 h-full",children:[e.jsxs("div",{className:"glass-panel rounded-[2rem] p-6 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute -top-20 -left-20 w-40 h-40 bg-indigo-500 rounded-full blur-[60px] opacity-20 group-hover:opacity-40 transition-opacity duration-700"}),e.jsxs("div",{className:"flex justify-between items-start relative z-10 mb-4",children:[e.jsxs("h3",{className:"font-bold text-slate-900 dark:text-white flex items-center gap-2 text-lg",children:[e.jsx(_t,{className:"text-indigo-500 dark:text-indigo-400"})," 个人档案"]}),!F&&e.jsx("button",{onClick:()=>{ce(!0),n("selection")},className:"p-3 bg-black/5 dark:bg-white/5 hover:bg-black/10 dark:hover:bg-white/10 text-indigo-500 dark:text-indigo-300 rounded-full transition-colors active:scale-95",children:e.jsx(ie,{size:18})})]}),e.jsxs("div",{className:"flex flex-col items-center relative z-10",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full p-1.5 border border-white/20 shadow-2xl bg-white/5 backdrop-blur-md",children:e.jsx("div",{className:"w-full h-full rounded-full overflow-hidden relative bg-black/5 dark:bg-black/20",children:F&&me?e.jsx("img",{src:me,className:"w-full h-full object-cover"}):s!=null&&s.avatar?e.jsx("img",{src:s.avatar,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400 dark:text-white/30",children:e.jsx(_t,{size:32})})})}),F&&e.jsxs("label",{className:`absolute bottom-0 right-0 w-8 h-8 bg-indigo-500 text-white rounded-full flex items-center justify-center shadow-lg cursor-pointer hover:bg-indigo-600 transition-colors transform hover:scale-105 border border-white/20 ${fe?"cursor-wait opacity-80":""}`,children:[fe?e.jsx(D,{size:14,className:"animate-spin"}):e.jsx(Ds,{size:14}),e.jsx("input",{type:"file",accept:"image/*",onChange:ls,className:"hidden",disabled:fe})]})]}),F?e.jsxs("div",{className:"w-full space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] text-slate-500 dark:text-white/50 font-bold uppercase tracking-wider",children:"姓名"}),e.jsx("input",{value:xe,onChange:t=>$e(t.target.value),className:"w-full p-2.5 glass-input rounded-xl text-sm font-bold text-center focus:outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] text-slate-500 dark:text-white/50 font-bold uppercase tracking-wider",children:"职位"}),e.jsx("input",{value:Fe,onChange:t=>Be(t.target.value),className:"w-full p-2.5 glass-input rounded-xl text-sm text-center focus:outline-none"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] text-slate-500 dark:text-white/50 font-bold uppercase tracking-wider",children:"所属部门"}),e.jsx("select",{value:he,onChange:t=>Ge(t.target.value),className:"w-full p-2.5 glass-input rounded-xl text-sm text-center focus:outline-none appearance-none",children:S.map(t=>e.jsx("option",{value:t.id,className:"text-black",children:t.name},t.id))})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-slate-200 dark:border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-[10px] text-slate-500 dark:text-white/50 font-bold uppercase tracking-wider",children:"所属组织"}),e.jsx("button",{onClick:()=>We(!A),className:`text-[10px] px-2 py-0.5 rounded border transition-colors ${A?"bg-indigo-50 dark:bg-indigo-500/20 text-indigo-600 dark:text-indigo-300 border-indigo-200 dark:border-indigo-500/30":"bg-slate-100 dark:bg-white/5 text-slate-500 dark:text-white/50 border-transparent"}`,children:A?"标准命名":"自定义命名"})]}),A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-xs font-bold text-slate-400",children:"西安欧亚学院"}),e.jsx("select",{value:be,onChange:t=>Qe(t.target.value),className:"flex-1 p-2 glass-input rounded-lg text-xs font-bold text-center focus:outline-none appearance-none truncate",children:Ps.map(t=>e.jsx("option",{value:t,className:"text-black",children:t},t))})]}),e.jsx("input",{value:B,onChange:t=>ge(t.target.value),className:"w-full p-2.5 glass-input rounded-xl text-sm text-center focus:outline-none",placeholder:"学生成长促进会"})]}):e.jsx("input",{value:B,onChange:t=>ge(t.target.value),className:"w-full p-2.5 glass-input rounded-xl text-sm text-center focus:outline-none font-bold",placeholder:"输入完整组织名称"})]}),e.jsxs("div",{className:"space-y-1 pt-2",children:[e.jsx("label",{className:"text-[10px] text-slate-500 dark:text-white/50 font-bold uppercase tracking-wider",children:"生日 (MM-DD)"}),e.jsx("input",{value:Je,onChange:t=>Ve(t.target.value),className:"w-full p-2.5 glass-input rounded-xl text-sm text-center focus:outline-none",placeholder:"01-01"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:()=>ce(!1),className:"flex-1 py-2.5 rounded-xl text-sm font-bold text-slate-500 dark:text-white/50 hover:bg-black/5 dark:hover:bg-white/10 transition-colors",children:"取消"}),e.jsx("button",{onClick:rs,className:"flex-1 py-2.5 bg-indigo-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-indigo-500/30 hover:bg-indigo-700 transition-colors active:scale-95",children:"保存"})]})]}):e.jsxs("div",{className:"text-center w-full",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2 text-glow",children:(s==null?void 0:s.name)||"未命名"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 mb-3",children:[e.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-50 dark:bg-white/10 text-indigo-500 dark:text-indigo-300 text-xs font-bold border border-indigo-100 dark:border-white/10",children:is}),e.jsxs("div",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-bold border ${ns((s==null?void 0:s.identity)||"user")}`,children:[(s==null?void 0:s.identity)&&s.identity!=="user"&&e.jsx(ae,{size:10,fill:"currentColor"}),te((s==null?void 0:s.identity)||"user")]})]}),e.jsx("div",{className:"text-sm text-slate-500 dark:text-white/50 font-medium mb-3",children:(s==null?void 0:s.position)||"成员"}),e.jsxs("div",{className:"text-xs text-slate-400 dark:text-white/40 mb-3 px-4 truncate max-w-full",children:[e.jsx(As,{size:12,className:"inline mr-1"}),(s==null?void 0:s.organization)||"未设置组织"]}),e.jsxs("button",{onClick:as,className:"w-full bg-black/5 dark:bg-white/5 rounded-lg p-2 font-mono text-[10px] text-slate-500 dark:text-white/50 border border-black/5 dark:border-white/5 mb-3 flex items-center justify-center gap-2 active:scale-95 transition-transform hover:bg-black/10 dark:hover:bg-white/10",children:["ID: ",(s==null?void 0:s.userId)||"--------",e.jsx(ne,{size:10})]}),(s==null?void 0:s.registerDate)&&e.jsxs("div",{className:"text-xs text-slate-400 dark:text-white/30 flex items-center justify-center gap-1",children:[e.jsx(St,{size:12})," 注册于 ",s.registerDate]})]})]})]}),e.jsxs("div",{className:"glass-panel rounded-2xl p-5 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${j.themeMode==="dark"?"bg-indigo-500/30 text-indigo-300":j.themeMode==="light"?"bg-orange-500/20 text-orange-400":"bg-slate-500/20 text-slate-400"}`,children:j.themeMode==="dark"?e.jsx(zt,{size:16}):j.themeMode==="light"?e.jsx(It,{size:16}):e.jsx(le,{size:16})}),e.jsx("div",{children:e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm",children:"外观模式"})})]}),e.jsxs("div",{className:"flex p-1 bg-black/5 dark:bg-white/5 rounded-xl border border-black/5 dark:border-white/5",children:[e.jsxs("button",{onClick:()=>Te("system"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-1.5 ${j.themeMode==="system"?"bg-white dark:bg-white/20 text-slate-900 dark:text-white shadow-sm":"text-slate-500 dark:text-white/40"}`,children:[e.jsx(le,{size:12})," 跟随系统"]}),e.jsxs("button",{onClick:()=>Te("light"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-1.5 ${j.themeMode==="light"?"bg-white dark:bg-white/20 text-orange-500 dark:text-orange-300 shadow-sm":"text-slate-500 dark:text-white/40"}`,children:[e.jsx(It,{size:12})," 浅色"]}),e.jsxs("button",{onClick:()=>Te("dark"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-1.5 ${j.themeMode==="dark"?"bg-white dark:bg-white/20 text-indigo-500 dark:text-indigo-300 shadow-sm":"text-slate-500 dark:text-white/40"}`,children:[e.jsx(zt,{size:12})," 深色"]})]})]}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-white/10 w-full"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-purple-500/20 text-purple-400",children:e.jsx(pa,{size:16})}),e.jsx("div",{className:"flex-1",children:e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm",children:"触感反馈"})})]}),e.jsx("div",{className:"flex gap-2 p-1 bg-black/5 dark:bg-white/5 rounded-xl border border-black/5 dark:border-white/5",children:["关闭","轻柔","适中","强烈"].map((t,a)=>e.jsx("button",{onClick:()=>ss(a),className:`flex-1 py-1.5 rounded-lg text-[10px] font-bold transition-all ${j.hapticIntensity===a?"bg-white dark:bg-white/20 text-purple-600 dark:text-purple-300 shadow-sm":"text-slate-400 dark:text-white/40 hover:text-slate-600 dark:hover:text-white/70"}`,children:t},a))})]})]}),e.jsxs("div",{className:"hidden lg:flex flex-col gap-2 mt-auto",children:[e.jsx("button",{onClick:()=>r("restore_identity"),className:"w-full p-2 text-center text-[10px] text-slate-400 hover:text-indigo-500 transition-colors",children:"申请恢复管理员身份"}),e.jsxs("button",{onClick:ct,className:"w-full glass-panel border border-red-500/20 text-red-500 dark:text-red-400 font-bold py-3.5 rounded-[2rem] hover:bg-red-500/10 hover:text-red-600 dark:hover:text-red-300 active:scale-[0.98] transition-all flex items-center justify-center gap-3 group shadow-sm",children:[e.jsx(Re,{size:16,className:"group-hover:-translate-x-1 transition-transform"}),"退出登录"]})]})]}),e.jsxs("div",{className:"lg:col-span-8 flex flex-col h-full gap-6",children:[ds(s==null?void 0:s.identity)&&e.jsxs("div",{className:"glass-panel rounded-[2rem] overflow-hidden bg-white/50 dark:bg-white/5 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-500/5 to-blue-500/5 pointer-events-none"}),e.jsxs("div",{className:"relative z-10 p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl flex items-center justify-center text-white shadow-lg",children:e.jsx(ra,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-3 tracking-tight",children:"管理员控制台"}),e.jsx("p",{className:"text-slate-500 dark:text-white/60 text-xs mt-1 font-medium",children:"Administrator Console"})]})]}),e.jsx("button",{onClick:()=>r("help_admin"),className:"p-2 text-slate-400 hover:text-indigo-500 transition-colors",children:e.jsx(Et,{size:20})})]}),(s==null?void 0:s.identity)==="temp_admin"&&e.jsxs("div",{className:"bg-amber-100 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/20 p-4 rounded-xl mb-6 flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-500 text-white rounded-lg shrink-0 animate-pulse",children:e.jsx(ga,{size:16})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-amber-700 dark:text-amber-400 text-sm mb-1",children:"临时管理员权限提示"}),e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-300/80 leading-relaxed",children:["您的临时管理权限有效期仅为 ",e.jsx("span",{className:"font-bold",children:"12小时"}),"。请抓紧时间完成配置更新与管理操作。过期后将自动降级为普通用户。"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[((s==null?void 0:s.identity)==="permanent_admin"||(s==null?void 0:s.identity)==="long_term_admin")&&e.jsxs("button",{onClick:()=>{V((s.identity==="permanent_admin","long_term_admin")),ms()},className:"bg-white/60 dark:bg-white/5 border border-white/60 dark:border-white/10 p-4 rounded-xl flex flex-col items-center justify-center text-center gap-2 hover:bg-white/80 dark:hover:bg-white/10 transition-colors active:scale-95 group relative overflow-hidden",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-500/20 text-amber-600 dark:text-amber-400 flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(Jt,{size:20})}),e.jsx("span",{className:"font-bold text-slate-800 dark:text-white text-sm",children:"权限传承 / 分配"}),e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40",children:"Grant Authority"})]}),e.jsxs("button",{onClick:()=>{v(ue),H("basic"),r("global_edit"),n("selection")},className:"bg-white/60 dark:bg-white/5 border border-white/60 dark:border-white/10 p-4 rounded-xl flex flex-col items-center justify-center text-center gap-2 hover:bg-white/80 dark:hover:bg-white/10 transition-colors active:scale-95 group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(Dt,{size:20})}),e.jsx("span",{className:"font-bold text-slate-800 dark:text-white text-sm",children:"全局资源配置"}),e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40",children:"Manage Links & Info"})]}),e.jsxs("button",{onClick:()=>{r("dept_manage"),n("selection")},className:"bg-white/60 dark:bg-white/5 border border-white/60 dark:border-white/10 p-4 rounded-xl flex flex-col items-center justify-center text-center gap-2 hover:bg-white/80 dark:hover:bg-white/10 transition-colors active:scale-95 group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 dark:bg-green-500/20 text-green-600 dark:text-green-400 flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(Pt,{size:20})}),e.jsx("span",{className:"font-bold text-slate-800 dark:text-white text-sm",children:"部门管理"}),e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40",children:"Add/Edit Depts"})]}),e.jsxs("button",{onClick:()=>{Ee(""),M("global_only"),q(!1),X(""),r("export_cimbar"),n("selection")},className:"bg-white/60 dark:bg-white/5 border border-white/60 dark:border-white/10 p-4 rounded-xl flex flex-col items-center justify-center text-center gap-2 hover:bg-white/80 dark:hover:bg-white/10 transition-colors active:scale-95 group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-500/20 text-purple-600 dark:text-purple-400 flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(Qs,{size:20})}),e.jsx("span",{className:"font-bold text-slate-800 dark:text-white text-sm",children:"分享全局配置"}),e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40",children:"Share Config (Safe)"})]})]})]})]}),e.jsxs("div",{className:"glass-panel rounded-[2rem] flex flex-col overflow-hidden bg-white/50 dark:bg-white/5 flex-1 min-h-[400px]",children:[e.jsx("div",{className:"relative shrink-0 border-b border-gray-200 dark:border-white/10 overflow-hidden bg-slate-50/50 dark:bg-[#0f172a]",children:e.jsx("div",{className:"relative z-10 p-6 md:p-8",children:e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center shadow-lg border border-white/50 dark:border-white/10 group overflow-hidden",children:e.jsx(ae,{className:"relative z-10 text-blue-600 dark:text-indigo-400",size:24,strokeWidth:2})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-3 tracking-tight",children:"安全配置中心"}),e.jsx("p",{className:"text-slate-500 dark:text-white/60 text-xs mt-1 font-medium",children:"迁移设备 • 应用更新备份 • 数据传输"})]})]}),e.jsx("button",{onClick:()=>r("help_security"),className:"p-2 text-slate-400 hover:text-indigo-500 transition-colors",children:e.jsx(Et,{size:20})})]})})}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row p-6 md:p-8 gap-8 overflow-y-auto hide-scrollbar",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/10 dark:bg-blue-500/20 text-blue-500 dark:text-blue-400 flex items-center justify-center border border-blue-500/20 dark:border-blue-500/30",children:e.jsx(na,{size:16})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm",children:"标准归档"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-white/50",children:"JSON 格式备份文件"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>{q(!1),X(""),M("full"),r("export_file"),n("selection")},className:"w-full py-3.5 glass-card hover:bg-black/5 dark:hover:bg-white/10 rounded-2xl flex items-center justify-between px-5 transition-all group active:scale-[0.98]",children:e.jsxs("span",{className:"font-bold text-slate-700 dark:text-white/80 flex items-center gap-2 text-sm",children:[e.jsx(de,{size:16})," 导出数据文件"]})}),e.jsxs("label",{className:"w-full py-3.5 glass-card hover:bg-black/5 dark:hover:bg-white/10 rounded-2xl flex items-center justify-between px-5 transition-all group active:scale-[0.98] cursor-pointer",onClick:()=>n("selection"),children:[e.jsxs("span",{className:"font-bold text-slate-700 dark:text-white/80 flex items-center gap-2 text-sm",children:[e.jsx(Ms,{size:16})," 恢复备份文件"]}),e.jsx("input",{ref:Me,type:"file",accept:".json",onChange:ps,className:"hidden"})]})]})]}),e.jsx("div",{className:"hidden md:block w-px bg-gray-200 dark:bg-white/10 self-stretch mx-2"}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/10 dark:bg-indigo-500/20 text-indigo-500 dark:text-indigo-400 flex items-center justify-center border border-indigo-500/20 dark:border-indigo-500/30",children:e.jsx(Ws,{size:16})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm",children:"彩色码传输"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-white/50",children:"支持备份恢复与权限激活"})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{Ee(""),X(""),q(!1),M("full"),r("export_cimbar"),n("selection")},className:"flex-1 py-5 bg-indigo-500 hover:bg-indigo-600 dark:bg-indigo-600 dark:hover:bg-indigo-700 text-white rounded-2xl shadow-lg shadow-indigo-500/30 active:scale-[0.98] transition-all flex flex-col items-center justify-center gap-1.5 group border border-indigo-400/50",children:[e.jsx(Ts,{size:24,className:"group-hover:scale-110 transition-transform text-white text-always-white"}),e.jsx("span",{className:"font-bold text-xs text-white text-always-white",children:"生成配置码"})]}),e.jsxs("button",{onClick:()=>{y("upload"),O(null),it(""),r("import_cimbar"),n("selection")},className:"flex-1 py-5 glass-card border border-dashed border-indigo-400/50 text-indigo-500 dark:text-indigo-300 rounded-2xl hover:bg-indigo-500/10 dark:hover:bg-indigo-500/20 transition-all active:scale-[0.98] flex flex-col items-center justify-center gap-1.5 font-bold text-xs",children:[e.jsx(Oe,{size:24}),"扫码获取配置 / 恢复数据"]})]})})]})]})]})]})]}),e.jsxs("div",{className:"mt-6 lg:hidden",children:[e.jsx("button",{onClick:()=>r("restore_identity"),className:"w-full p-3 rounded-xl border border-dashed border-slate-300 dark:border-white/20 text-slate-500 dark:text-white/50 text-xs font-bold hover:bg-black/5 dark:hover:bg-white/5 mb-3",children:"恢复管理员身份"}),e.jsxs("button",{onClick:ct,className:"w-full glass-card border border-red-500/20 text-red-500 dark:text-red-400 font-bold py-3.5 rounded-[2rem] hover:bg-red-500/10 hover:text-red-600 dark:hover:text-red-300 flex items-center justify-center gap-3 group shadow-sm active:scale-[0.98] transition-all",children:[e.jsx(Re,{size:16})," 退出登录"]})]})]}),d==="admin_grant"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:`glass-panel rounded-3xl p-6 md:p-8 w-full max-w-sm shadow-2xl relative bg-white/95 dark:bg-black/60 flex flex-col items-center text-center transition-all ${qt?"animate-shake border-red-500":""}`,onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),Q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-2 rounded-2xl shadow-inner border border-gray-200 mb-6",children:e.jsx("img",{src:Q,className:"w-48 h-48 object-contain",style:{imageRendering:"pixelated"}})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-1",children:"凭证已生成"}),e.jsxs("p",{className:"text-xs text-slate-500 mb-6",children:["请接收者在“安全配置中心”扫描此码",e.jsx("br",{}),"有效期至: ",new Date(Yt).toLocaleTimeString()]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>{ve(""),ke("")},className:"px-4 py-3 rounded-xl font-bold bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white",children:"返回"}),N==="long_term_admin"&&(s==null?void 0:s.identity)!=="permanent_admin"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:bt,className:"px-4 py-3 rounded-xl font-bold bg-indigo-50 dark:bg-indigo-500/20 text-indigo-600 dark:text-indigo-300",children:"保存"}),e.jsx("button",{onClick:gs,className:"flex-1 py-3 rounded-xl font-bold bg-red-600 text-white shadow-lg hover:bg-red-700",children:"交接并卸任"})]}):e.jsx("button",{onClick:bt,className:"flex-1 py-3 rounded-xl font-bold bg-indigo-600 text-white shadow-lg hover:bg-indigo-700",children:"保存凭证"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 dark:bg-amber-500/20 rounded-full flex items-center justify-center text-amber-500 dark:text-amber-400 mb-4",children:e.jsx(Jt,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:N==="long_term_admin"?"权限传承 (Inheritance)":"权限分配 (Distribution)"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 leading-relaxed",children:N==="long_term_admin"?(s==null?void 0:s.identity)==="permanent_admin"?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-amber-600 dark:text-amber-400 font-bold block mb-1",children:"你是第一批开拓者，传承后身份保留不会降级。"}),"愿你审慎行使无限传承的权利，寻找真正眼中有光、心中有火的继任者，将这份温暖与秩序传递下去。"]}):"生成长期管理员凭证。授予后请在确认对方接收成功后，手动点击卸任以完成交接。":"生成临时管理员凭证，有效期12小时。"}),e.jsxs("div",{className:"w-full space-y-4 mb-6",children:[e.jsxs("div",{className:"space-y-2 text-left",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-white/50 uppercase tracking-wider ml-1",children:"目标用户 ID (16位)"}),e.jsx("input",{value:J,onChange:t=>ke(t.target.value.trim()),placeholder:"请输入接收者的个人编号",className:"w-full p-4 glass-input rounded-xl text-center font-mono tracking-widest focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all"})]}),N==="long_term_admin"&&e.jsxs("div",{className:"space-y-2 text-left animate-fade-in",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-white/50 uppercase tracking-wider ml-1",children:"传承寄语 (可选)"}),e.jsx("textarea",{value:Ke,onChange:t=>et(t.target.value),placeholder:Vt,rows:3,className:"w-full p-3 glass-input rounded-xl text-sm leading-relaxed focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-all resize-none"})]}),e.jsxs("div",{className:"flex p-1 bg-black/5 dark:bg-white/5 rounded-xl",children:[e.jsx("button",{onClick:()=>V("temp_admin"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${N==="temp_admin"?"bg-white dark:bg-white/20 shadow-sm text-indigo-600 dark:text-white":"text-slate-500 dark:text-white/50"}`,children:"临时权限"}),((s==null?void 0:s.identity)==="permanent_admin"||(s==null?void 0:s.identity)==="long_term_admin")&&e.jsx("button",{onClick:()=>V("long_term_admin"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${N==="long_term_admin"?"bg-white dark:bg-white/20 shadow-sm text-amber-600 dark:text-amber-400":"text-slate-500 dark:text-white/50"}`,children:"长期传承"})]})]}),Xt?e.jsxs("div",{className:"space-y-3",children:[e.jsx(D,{className:"animate-spin mx-auto text-indigo-500",size:24}),e.jsxs("p",{className:"text-xs font-mono text-indigo-500",children:[W===0&&"INITIALIZING SECURE CHANNEL...",W===1&&"VERIFYING BIOMETRICS...",W===2&&"ENCRYPTING PAYLOAD...",W===3&&"SIGNING TOKEN..."]})]}):e.jsx("button",{onClick:bs,className:`w-full py-4 rounded-xl font-bold text-white shadow-lg transition-all active:scale-95 ${N==="long_term_admin"?"bg-gradient-to-r from-amber-500 to-orange-600 shadow-orange-500/30":"bg-indigo-600 hover:bg-indigo-700 shadow-indigo-500/30"}`,children:"生成授权凭证"})]})]})})}),d==="logout_joke"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm text-center bg-white/95 dark:bg-black/60 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-500/20 rounded-full flex items-center justify-center text-red-500 mx-auto mb-4",children:e.jsx(Re,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"确认退出?"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6",children:"退出后需重新登录或通过恢复码找回身份。"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>r(null),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 rounded-xl font-bold text-slate-600 dark:text-white/80",children:"取消"}),e.jsx("button",{onClick:()=>{Os("NEW_ACCOUNT")},className:"flex-1 py-3 bg-red-600 text-white rounded-xl font-bold shadow-lg",children:"确认退出"})]})]})})}),d==="restore_identity"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm text-center bg-white/95 dark:bg-black/60 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4",children:"恢复身份"}),e.jsx("textarea",{value:ye,onChange:t=>Kt(t.target.value),placeholder:"在此输入恢复代码...",className:"w-full h-24 p-3 glass-input rounded-xl text-xs font-mono mb-4 focus:outline-none"}),e.jsx("button",{onClick:Cs,className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg",children:"提交恢复"})]})})}),d==="version_info"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-[2rem] w-full max-w-md bg-white/95 dark:bg-gray-900/90 h-[75vh] flex flex-col relative overflow-hidden",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 z-50 p-2 text-white/50 hover:text-white transition-colors active:scale-95 bg-black/10 rounded-full backdrop-blur-md",children:e.jsx(f,{size:20})}),e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-500/10 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-purple-500/10 rounded-full blur-2xl -ml-10 -mb-10 pointer-events-none"}),e.jsx("div",{className:"p-6 pb-2 shrink-0",children:e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-indigo-500 to-purple-600 p-6 text-white rounded-3xl mb-6 shadow-xl shadow-indigo-500/20",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20",children:e.jsx(Ct,{size:60})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"inline-flex items-center gap-1 bg-white/20 backdrop-blur-sm px-2 py-0.5 rounded-full text-[10px] font-bold mb-2 border border-white/20",children:[e.jsx(Ht,{size:10,fill:"currentColor"})," MAJOR UPDATE"]}),e.jsx("h1",{className:"text-4xl font-bold tracking-tight mb-1",children:"v2.5.0"}),e.jsx("p",{className:"text-white/80 text-sm font-medium",children:"CIMBAR Protocol & Safety Core"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 px-6 pb-6 custom-scrollbar",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 p-4 rounded-2xl border border-gray-100 dark:border-white/5 flex flex-col items-center text-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-500/20 text-blue-500 dark:text-blue-300 flex items-center justify-center mb-1",children:e.jsx(Oe,{size:20})}),e.jsx("div",{className:"font-bold text-xs text-slate-700 dark:text-white/90",children:"CIMBAR 传输"}),e.jsx("div",{className:"text-[10px] text-slate-400 dark:text-white/50 leading-tight",children:"高密度彩色码配置同步"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 p-4 rounded-2xl border border-gray-100 dark:border-white/5 flex flex-col items-center text-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 dark:bg-green-500/20 text-green-500 dark:text-green-300 flex items-center justify-center mb-1",children:e.jsx(ae,{size:20})}),e.jsx("div",{className:"font-bold text-xs text-slate-700 dark:text-white/90",children:"灾难恢复"}),e.jsx("div",{className:"text-[10px] text-slate-400 dark:text-white/50 leading-tight",children:"权限熔断与身份找回"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 p-4 rounded-2xl border border-gray-100 dark:border-white/5 flex flex-col items-center text-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-500/20 text-purple-500 dark:text-purple-300 flex items-center justify-center mb-1",children:e.jsx(le,{size:20})}),e.jsx("div",{className:"font-bold text-xs text-slate-700 dark:text-white/90",children:"视觉升级"}),e.jsx("div",{className:"text-[10px] text-slate-400 dark:text-white/50 leading-tight",children:"全新流体与玻璃拟态UI"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 p-4 rounded-2xl border border-gray-100 dark:border-white/5 flex flex-col items-center text-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-500/20 text-amber-500 dark:text-amber-300 flex items-center justify-center mb-1",children:e.jsx(xa,{size:20})}),e.jsx("div",{className:"font-bold text-xs text-slate-700 dark:text-white/90",children:"身份传承"}),e.jsx("div",{className:"text-[10px] text-slate-400 dark:text-white/50 leading-tight",children:"加密寄语与权限交接"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-sm text-slate-800 dark:text-white flex items-center gap-2 mb-4",children:[e.jsx(oa,{size:16,className:"text-slate-400"})," 更新日志"]}),e.jsxs("div",{className:"relative pl-4 border-l-2 border-gray-100 dark:border-white/10 space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[21px] top-0 w-3 h-3 bg-indigo-500 rounded-full border-2 border-white dark:border-gray-900"}),e.jsx("div",{className:"text-xs font-bold text-indigo-500 mb-1",children:"Feature"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-white/70",children:"新增 CIMBAR (Color Icon Matrix Barcode) 协议，支持离线环境下的复杂配置传输。"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[21px] top-0 w-3 h-3 bg-indigo-500 rounded-full border-2 border-white dark:border-gray-900"}),e.jsx("div",{className:"text-xs font-bold text-indigo-500 mb-1",children:"Improvement"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-white/70",children:"重构安全中心，增加身份恢复代码 (Recovery Code) 机制，防止误操作导致权限丢失。"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[21px] top-0 w-3 h-3 bg-indigo-500 rounded-full border-2 border-white dark:border-gray-900"}),e.jsx("div",{className:"text-xs font-bold text-indigo-500 mb-1",children:"UI/UX"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-white/70",children:"优化深色模式下的对比度；新增触感反馈引擎；优化移动端手势操作。"})]})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-500/10 border border-blue-100 dark:border-blue-500/20 rounded-xl text-xs text-slate-600 dark:text-white/80 flex items-start gap-3",children:[e.jsx(Rs,{size:16,className:"text-blue-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"leading-relaxed",children:[e.jsx("span",{className:"font-bold block text-blue-700 dark:text-blue-400 mb-1",children:"如何更新?"}),"由于采用 PWA 离线架构，请先在安全中心导出全量备份，卸载旧版应用后重新安装，最后导入备份即可。"]})]}),e.jsxs("div",{className:"p-6 bg-amber-50/50 dark:bg-amber-900/5 border border-amber-100 dark:border-amber-500/10 rounded-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 text-6xl text-amber-200 dark:text-amber-500/10 font-serif -mt-2 -ml-2 select-none",children:"“"}),e.jsx("p",{className:"relative z-10 text-xs text-amber-900/80 dark:text-amber-100/60 font-serif leading-relaxed italic text-center px-4",children:"这个项目起源于人文教育学院 2306 班的一名学子对“数字化秩序”的探索。代码或许是冰冷的逻辑，但传承是温热的脉搏。"}),e.jsx("div",{className:"text-center mt-3 text-[10px] text-amber-800/40 dark:text-amber-100/30 font-bold uppercase tracking-widest",children:"— To Successors"})]})]}),e.jsx("div",{className:"p-6 pt-2 shrink-0",children:e.jsx("button",{onClick:()=>r(null),className:"w-full py-3 bg-gray-100 dark:bg-white/10 rounded-xl font-bold text-slate-600 dark:text-white/80 hover:bg-gray-200 dark:hover:bg-white/20 transition-colors",children:"关闭"})})]})})}),d==="dept_manage"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-lg bg-white/95 dark:bg-black/60 max-h-[85vh] flex flex-col relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4 shrink-0",children:"部门管理"}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 custom-scrollbar",children:S.map(t=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-white/5 rounded-xl border border-gray-100 dark:border-white/10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-white text-sm",children:t.name}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-white/50",children:t.description||"无描述"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{C(t),r("dept_edit")},className:"p-2 bg-indigo-50 dark:bg-indigo-500/20 text-indigo-500 dark:text-indigo-300 rounded-lg hover:bg-indigo-100 dark:hover:bg-indigo-500/30 transition-colors",children:e.jsx(ie,{size:16})}),e.jsx("button",{onClick:()=>mt(t.id),className:"p-2 bg-red-50 dark:bg-red-500/20 text-red-500 dark:text-red-300 rounded-lg hover:bg-red-100 dark:hover:bg-red-500/30 transition-colors",children:e.jsx(At,{size:16})})]})]},t.id))}),e.jsx("div",{className:"pt-4 mt-2 border-t border-gray-200 dark:border-white/10 shrink-0",children:e.jsxs("button",{onClick:()=>{C({id:"NEW",name:"",description:"",cards:[],announcements:[]}),r("dept_edit")},className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:[e.jsx(Mt,{size:18})," 新增部门"]})})]})})}),d==="dept_edit"&&x&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r("dept_manage"),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm bg-white/95 dark:bg-black/60 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4",children:x.id==="NEW"?"新增部门":"编辑部门"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-white/50 uppercase",children:"部门名称"}),e.jsx("input",{value:x.name,onChange:t=>C({...x,name:t.target.value}),className:"w-full p-3 glass-input rounded-xl text-sm",placeholder:"例如：宣传部"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-white/50 uppercase",children:"描述"}),e.jsx("textarea",{value:x.description,onChange:t=>C({...x,description:t.target.value}),className:"w-full p-3 glass-input rounded-xl text-sm resize-none h-24",placeholder:"部门职责简述..."})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>r("dept_manage"),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 rounded-xl font-bold text-slate-600 dark:text-white/80",children:"取消"}),e.jsx("button",{onClick:ht,className:"flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg",children:"保存"})]})]})})}),d==="global_edit"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-lg bg-white/95 dark:bg-black/60 max-h-[85vh] flex flex-col relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4 shrink-0",children:"全局资源配置"}),e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 hide-scrollbar",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("button",{onClick:()=>H("basic"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${z==="basic"?"bg-indigo-500 text-white":"bg-gray-100 dark:bg-white/10"}`,children:"基础信息"}),e.jsx("button",{onClick:()=>H("cards"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${z==="cards"?"bg-indigo-500 text-white":"bg-gray-100 dark:bg-white/10"}`,children:"首页卡片"}),e.jsx("button",{onClick:()=>H("guide"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${z==="guide"?"bg-indigo-500 text-white":"bg-gray-100 dark:bg-white/10"}`,children:"教程文档"})]}),z==="basic"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"反馈链接 (Feedback URL)"}),e.jsx("input",{value:m.feedbackUrl,onChange:t=>v({...m,feedbackUrl:t.target.value}),className:"w-full p-2 glass-input rounded-lg text-sm"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"开源地址 (GitHub URL)"}),e.jsx("input",{value:m.githubUrl,onChange:t=>v({...m,githubUrl:t.target.value}),className:"w-full p-2 glass-input rounded-lg text-sm"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"联系电话"}),e.jsx("input",{value:m.contactPhone,onChange:t=>v({...m,contactPhone:t.target.value}),className:"w-full p-2 glass-input rounded-lg text-sm"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"联系二维码 (企业微信)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[m.contactQrCode&&e.jsx("img",{src:m.contactQrCode,className:"w-16 h-16 object-contain border rounded-lg"}),e.jsxs("label",{className:`px-4 py-2 bg-gray-100 dark:bg-white/10 rounded-lg text-xs font-bold cursor-pointer flex items-center gap-2 ${je?"opacity-70 cursor-wait":""}`,children:[je?e.jsx(D,{size:12,className:"animate-spin"}):"上传图片",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:cs,disabled:je})]})]})]})]}),z==="cards"&&e.jsx("div",{className:"space-y-4",children:["todoCard1","todoCard2","feedbackCard1","feedbackCard2","githubCard"].map(t=>{const a=m[t]||{};return e.jsxs("div",{className:"p-3 border border-gray-100 dark:border-white/10 rounded-xl bg-gray-50 dark:bg-white/5",children:[e.jsx("div",{className:"text-xs font-bold text-indigo-500 mb-2 uppercase",children:t}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("input",{value:a.title||"",onChange:l=>v({...m,[t]:{...a,title:l.target.value}}),placeholder:"标题",className:"p-2 glass-input rounded-lg text-xs"}),e.jsx("input",{value:a.subtitle||"",onChange:l=>v({...m,[t]:{...a,subtitle:l.target.value}}),placeholder:"副标题",className:"p-2 glass-input rounded-lg text-xs"})]}),e.jsx("input",{value:a.url||"",onChange:l=>v({...m,[t]:{...a,url:l.target.value}}),placeholder:"URL (可选)",className:"w-full p-2 glass-input rounded-lg text-xs mb-2"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"图标:"}),e.jsx(hs,{value:a.iconName||"Link",onChange:l=>v({...m,[t]:{...a,iconName:l}})})]})]},t)})}),z==="guide"&&e.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"日历同步教程 (HTML 支持)"}),e.jsx("textarea",{value:m.calendarGuideHtml||"",onChange:t=>v({...m,calendarGuideHtml:t.target.value}),className:"w-full flex-1 p-3 glass-input rounded-lg text-xs font-mono resize-none focus:outline-none",placeholder:"<div>输入自定义 HTML 内容...</div>"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-4 shrink-0",children:[e.jsx("button",{onClick:()=>r(null),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 rounded-xl font-bold text-slate-600 dark:text-white/80",children:"取消"}),e.jsx("button",{onClick:os,className:"flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg",children:"保存配置"})]})]})})}),(d==="export_cimbar"||d==="export_file")&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm text-center bg-white/95 dark:bg-black/60 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:d==="export_cimbar"?"生成彩色配置码":"导出备份文件"}),ts?e.jsxs("div",{className:"py-12 flex flex-col items-center gap-4",children:[e.jsx(D,{className:"animate-spin text-indigo-500",size:32}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60",children:"正在加密打包数据..."})]}):K?e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl border border-gray-200 mb-6",children:e.jsx("img",{src:K,className:"w-full h-auto object-contain",style:{imageRendering:"pixelated"}})}),e.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"请使用另一台设备在“安全中心”扫描恢复"}),e.jsxs("button",{onClick:ws,className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:[e.jsx(de,{size:18})," 保存图片"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-indigo-50 dark:bg-indigo-500/10 rounded-xl text-left border border-indigo-100 dark:border-indigo-500/20",children:[e.jsxs("h4",{className:"font-bold text-indigo-700 dark:text-indigo-300 text-sm mb-1 flex items-center gap-2",children:[e.jsx(Tt,{size:14})," 安全加密 (可选)"]}),e.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:I,onChange:t=>q(t.target.checked)}),e.jsx("div",{className:"w-9 h-5 bg-gray-200 dark:bg-white/20 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-indigo-600"})]}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-white/60",children:I?"已启用":"未启用"})]}),I&&e.jsx("input",{type:"password",placeholder:"设置密码",value:Z,onChange:t=>X(t.target.value),className:"w-full mt-3 p-2 glass-input rounded-lg text-sm"})]}),d==="export_file"&&e.jsxs("div",{className:"flex p-1 bg-black/5 dark:bg-white/5 rounded-xl",children:[e.jsx("button",{onClick:()=>M("full"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${E==="full"?"bg-white dark:bg-white/20 shadow-sm text-indigo-600 dark:text-indigo-400":"text-slate-500 dark:text-white/50"}`,children:"全部数据"}),e.jsx("button",{onClick:()=>M("profile_only"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${E==="profile_only"?"bg-white dark:bg-white/20 shadow-sm text-indigo-600 dark:text-indigo-400":"text-slate-500 dark:text-white/50"}`,children:"仅个人"})]}),e.jsx("button",{onClick:d==="export_cimbar"?js:us,disabled:I&&!Z,className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:d==="export_cimbar"?"生成彩色码":"导出文件"})]})]})})}),(d==="import_cimbar"||d==="import_file_decrypt")&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm text-center bg-white/95 dark:bg-black/60 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),T==="upload"&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-6",children:"扫描配置码"}),e.jsxs("label",{className:`w-full h-32 border-2 border-dashed border-slate-300 dark:border-white/20 rounded-2xl flex flex-col items-center justify-center cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 transition-colors mb-3 ${we?"opacity-70 cursor-wait":""}`,children:[we?e.jsxs(e.Fragment,{children:[e.jsx(D,{size:24,className:"animate-spin text-indigo-500 mb-2"}),e.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-white/80",children:"正在解析配置码..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 dark:bg-white/10 flex items-center justify-center mb-2 text-indigo-500 dark:text-white",children:e.jsx(Oe,{size:20})}),e.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-white/80",children:"上传二维码图片"})]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:vs,disabled:we})]}),e.jsxs("div",{className:"relative flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"h-px bg-gray-200 dark:bg-white/10 flex-1"}),e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40 font-bold uppercase",children:"OR"}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-white/10 flex-1"})]}),e.jsxs("button",{onClick:ks,className:"w-full py-3 bg-gray-100 dark:bg-white/10 rounded-xl font-bold text-slate-600 dark:text-white/80 flex items-center justify-center gap-2 hover:bg-gray-200 dark:hover:bg-white/20 active:scale-95 transition-all",children:[e.jsx(ne,{size:16})," 粘贴文本数据"]}),R&&e.jsx("p",{className:"text-red-500 text-xs mt-4 mb-2",children:R})]}),(T==="decrypt"||d==="import_file_decrypt")&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 dark:bg-amber-500/20 rounded-full flex items-center justify-center text-amber-500 dark:text-amber-400 mx-auto mb-4",children:e.jsx(Tt,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"输入密码"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/60 mb-6",children:"该备份已加密，请输入密码解锁"}),e.jsx("input",{type:"password",value:De,onChange:t=>nt(t.target.value),className:"w-full p-3 glass-input rounded-xl text-center text-lg mb-4",placeholder:"******",autoFocus:!0}),R&&e.jsx("p",{className:"text-red-500 text-xs mb-4",children:R}),e.jsx("button",{onClick:d==="import_file_decrypt"?fs:Ns,className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg",children:"解密"})]}),T==="confirm"&&h&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-500/20 rounded-full flex items-center justify-center text-green-500 dark:text-green-400 mx-auto mb-4",children:e.jsx(Ls,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"数据就绪"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-xl p-4 mb-6 text-left border border-gray-100 dark:border-white/10",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/60 mb-1",children:"包含内容:"}),h.profile?e.jsxs("div",{className:"font-bold text-slate-800 dark:text-white text-sm",children:["个人档案: ",h.profile.name]}):(jt=h.active)!=null&&jt.profile?e.jsxs("div",{className:"font-bold text-slate-800 dark:text-white text-sm",children:["个人档案: ",h.active.profile.name," (及其他账号)"]}):e.jsx("div",{className:"font-bold text-slate-800 dark:text-white text-sm",children:"仅配置数据 (无个人档案)"}),e.jsx("div",{className:"text-xs text-slate-400 mt-2",children:"恢复将覆盖当前同名数据"})]}),e.jsx("button",{onClick:ys,className:"w-full py-3 bg-green-600 text-white rounded-xl font-bold shadow-lg",children:"确认恢复"})]}),T==="auth_check"&&e.jsx("div",{className:"animate-fade-in",children:ot==="verifying"?e.jsxs("div",{className:"py-12",children:[e.jsx(D,{className:"animate-spin text-indigo-500 mx-auto mb-4",size:32}),e.jsx("p",{className:"text-sm font-bold text-slate-600 dark:text-white/80",children:"正在验证凭证签名..."})]}):ot==="error"?e.jsxs("div",{className:"py-6",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-500/20 rounded-full flex items-center justify-center text-red-500 dark:text-red-400 mx-auto mb-4",children:e.jsx(Ys,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"验证失败"}),e.jsx("p",{className:"text-sm text-red-500 mb-6",children:R}),Ce&&e.jsx("div",{className:"mb-6 animate-fade-in",children:e.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-500/10 rounded-xl border border-amber-200 dark:border-amber-500/20 text-left mb-2",children:[e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 font-bold mb-1",children:"恢复代码 (Recovery Code)"}),e.jsx("p",{className:"text-[10px] text-amber-600/80 dark:text-amber-400/80 leading-tight mb-2",children:"请将此代码发送给授权人以恢复身份。"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{readOnly:!0,value:Ce,className:"flex-1 p-2 bg-white dark:bg-black/20 rounded-lg text-xs font-mono border border-amber-200 dark:border-amber-500/20 text-slate-600 dark:text-white/80"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(Ce),n("success"),alert("恢复代码已复制")},className:"p-2 bg-amber-100 dark:bg-amber-500/20 text-amber-600 dark:text-amber-400 rounded-lg",children:e.jsx(ne,{size:14})})]})]})}),e.jsx("button",{onClick:()=>{r(null),y("upload")},className:"w-full py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white rounded-xl font-bold",children:"关闭"})]}):e.jsxs("div",{className:"py-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-500/20 rounded-full flex items-center justify-center text-green-500 dark:text-green-400 mx-auto mb-4",children:e.jsx(ae,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"权限验证通过"}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6",children:["即将激活: ",e.jsx("span",{className:"font-bold text-indigo-500",children:te(h==null?void 0:h.role)})]}),e.jsx("button",{onClick:pt,className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg",children:"激活权限"})]})}),T==="legacy_reveal"&&h&&e.jsxs("div",{className:"animate-fade-in text-left",children:[e.jsx("h3",{className:"text-2xl font-serif font-bold text-slate-900 dark:text-white mb-6 text-center",children:"传承寄语"}),e.jsxs("div",{className:"relative p-6 bg-amber-50 dark:bg-amber-900/10 rounded-2xl border border-amber-100 dark:border-amber-500/20 mb-8",children:[e.jsx("div",{className:"absolute top-0 left-0 text-6xl text-amber-200 dark:text-amber-500/20 font-serif -mt-4 -ml-2",children:"“"}),e.jsx("p",{className:"relative z-10 text-amber-900 dark:text-amber-100/90 text-lg font-serif italic leading-relaxed text-center",children:h.msg}),e.jsx("div",{className:"absolute bottom-0 right-0 text-6xl text-amber-200 dark:text-amber-500/20 font-serif -mb-8 -mr-2",children:"”"})]}),e.jsx("button",{onClick:pt,className:"w-full py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-xl font-bold shadow-lg shadow-amber-500/30",children:"接受传承"})]})]})})}),(d==="help_admin"||d==="help_security")&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm bg-white/95 dark:bg-black/60 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-2",children:"帮助说明"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 leading-relaxed",children:d==="help_admin"?"管理员控制台允许您修改全局配置（如首页卡片链接）、分配权限给其他成员。长期管理员可生成包含寄语的传承码，将权限移交给继任者。":"安全中心用于数据的备份与恢复。支持生成加密的 JSON 文件或 CIMBAR 彩色码。CIMBAR 是一种高密度二维码，可直接通过扫描图片在不同设备间传输大量数据。"}),e.jsx("button",{onClick:()=>r(null),className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold",children:"了解"})]})})}),d==="export_selector"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm bg-white/95 dark:bg-black/60 shadow-2xl relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2 text-center",children:"选择导出方式"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 text-center",children:"请根据当前设备环境选择最合适的传输方式"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-indigo-50 dark:bg-indigo-500/10 border border-indigo-100 dark:border-indigo-500/20 hover:bg-indigo-100 dark:hover:bg-indigo-500/20 transition-colors cursor-pointer group",onClick:()=>{if(rt==="file"){const t=new Blob([_e],{type:"application/json"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download=lt,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}else{const t=document.createElement("a");t.href=es,t.download=lt,document.body.appendChild(t),t.click(),document.body.removeChild(t)}n("success")},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-500 text-white flex items-center justify-center shrink-0 shadow-lg shadow-indigo-500/30 group-hover:scale-110 transition-transform",children:e.jsx(Ot,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-base mb-1",children:"电脑端导出"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/60",children:rt==="file"?"下载 JSON 文件":"下载 PNG 图片"})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white dark:bg-white/10 flex items-center justify-center text-slate-400",children:e.jsx(de,{size:16})})]})}),e.jsx("div",{className:"p-4 rounded-2xl bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 hover:border-indigo-500 dark:hover:border-indigo-400 transition-colors cursor-pointer group",onClick:()=>{},children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"flex items-center gap-4 list-none cursor-pointer",onClick:()=>n("selection"),children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500 text-white flex items-center justify-center shrink-0 shadow-lg shadow-green-500/30 group-hover:scale-110 transition-transform",children:e.jsx(le,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-base mb-1",children:"移动端导出"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/60",children:"复制加密文本数据"})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white dark:bg-white/10 flex items-center justify-center text-slate-400 group-open:rotate-90 transition-transform",children:e.jsx(Rt,{size:16})})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-white/10 animate-fade-in",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 mb-2",children:"请复制以下内容发送到移动设备："}),e.jsx("textarea",{readOnly:!0,value:_e,className:"w-full h-32 p-3 glass-input rounded-xl text-xs font-mono mb-3 focus:outline-none resize-none",onClick:t=>t.target.select()}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(_e),n("success"),alert("已复制到剪贴板")},className:"w-full py-2 bg-green-500 hover:bg-green-600 text-white rounded-xl font-bold text-sm shadow-lg shadow-green-500/30 active:scale-95 transition-all flex items-center justify-center gap-2",children:[e.jsx(ne,{size:16})," 复制文本"]})]})]})})]}),e.jsx("button",{onClick:()=>r(null),className:"w-full mt-6 py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-white/20 transition-colors",children:"关闭"})]})})}),d==="manual_import"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[1000] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm bg-white/95 dark:bg-black/60 shadow-2xl relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("div",{className:"w-16 h-16 bg-indigo-50 dark:bg-indigo-500/20 rounded-full flex items-center justify-center text-indigo-500 dark:text-indigo-400 mx-auto mb-4 border border-indigo-100 dark:border-indigo-500/30",children:e.jsx(ie,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2 text-center",children:"手动输入数据"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 text-center",children:"无法读取剪贴板，请长按下方输入框粘贴"}),e.jsx("textarea",{value:pe,onChange:t=>Ye(t.target.value),placeholder:"在此处粘贴配置数据...",className:"w-full h-40 p-4 glass-input rounded-xl text-xs font-mono mb-4 focus:outline-none resize-none",autoFocus:!0}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>r("import_cimbar"),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-white/20 transition-colors",children:"取消"}),e.jsx("button",{onClick:()=>gt(pe),disabled:!pe,className:"flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"确认导入"})]})]})})}),d==="dept_manage"&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-md bg-white/95 dark:bg-black/60 max-h-[85vh] flex flex-col relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsxs("div",{className:"mb-4 shrink-0",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1",children:"部门管理"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50",children:"管理组织架构与部门列表"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 hide-scrollbar mb-4",children:S.map(t=>e.jsxs("div",{className:"p-3 bg-white dark:bg-white/5 rounded-xl border border-gray-100 dark:border-white/10 flex items-center justify-between group",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-sm text-slate-800 dark:text-white flex items-center gap-2",children:[t.name,t.isTopLevel&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 bg-indigo-100 dark:bg-indigo-500/20 text-indigo-600 dark:text-indigo-300 rounded",children:"顶级"})]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-white/50 line-clamp-1",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{C(t),r("dept_edit"),n("selection")},className:"p-2 text-slate-400 hover:text-indigo-500 transition-colors",children:e.jsx(ie,{size:16})}),e.jsx("button",{onClick:()=>mt(t.id),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(At,{size:16})})]})]},t.id))}),e.jsxs("button",{onClick:()=>{C({id:"NEW",name:"",description:"",cards:[],announcements:[]}),r("dept_edit"),n("selection")},className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:[e.jsx(Mt,{size:18})," 新增部门"]})]})})}),d==="dept_edit"&&x&&e.jsx(p,{children:e.jsx("div",{className:"fixed inset-0 z-[1000] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>r("dept_manage"),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm bg-white/95 dark:bg-black/60 shadow-2xl relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>r("dept_manage"),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(f,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-6 text-center",children:x.id==="NEW"?"新增部门":"编辑部门"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-white/50 uppercase tracking-wider ml-1",children:"部门名称"}),e.jsx("input",{value:x.name,onChange:t=>C({...x,name:t.target.value}),placeholder:"例如：技术部",className:"w-full p-3 glass-input rounded-xl text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",autoFocus:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-white/50 uppercase tracking-wider ml-1",children:"部门描述"}),e.jsx("textarea",{value:x.description,onChange:t=>C({...x,description:t.target.value}),placeholder:"简要描述部门职责...",rows:3,className:"w-full p-3 glass-input rounded-xl text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 resize-none"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>r("dept_manage"),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-white/20 transition-colors",children:"取消"}),e.jsx("button",{onClick:ht,disabled:!x.name,className:"flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg disabled:opacity-50",children:"保存"})]})]})})})]})};export{ka as default};
