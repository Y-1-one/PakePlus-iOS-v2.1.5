import{c as y,r as u,g as be,a as fe,j as e,A as I,t as l,C as we,T as O,P as je,b as ke,d as ve,L as Ne,G as ye,e as Ce,U as Se,M as Pe,p as ze,s as Me}from"./index-BDj9p9M6.js";import{B as D,S as F,a as De,P as $e,C as Q,L as V,Z as A,D as Z,I as J,b as _e,c as Te,M as Le,d as qe,F as Ae}from"./zap-DtEwEg4Z.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],Ue=y("megaphone",Ee);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ge=y("pen-line",Be);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],Ie=y("pin-off",Re);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],q=y("pin",Fe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],He=y("square-pen",Ve);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],H=y("triangle-alert",Oe),S=({children:o})=>ve.createPortal(o,document.body),W=u.memo(({name:o,size:d=20})=>{switch(o){case"FileText":return e.jsx(Ae,{size:d});case"Monitor":return e.jsx(Pe,{size:d});case"Users":return e.jsx(Se,{size:d});case"Calendar":return e.jsx(Ce,{size:d});case"Image":return e.jsx(J,{size:d});case"Briefcase":return e.jsx(D,{size:d});case"Zap":return e.jsx(A,{size:d});case"Coffee":return e.jsx(qe,{size:d});case"Download":return e.jsx(Z,{size:d});case"Clock":return e.jsx(Q,{size:d});case"Globe":return e.jsx(ye,{size:d});case"MessageCircle":return e.jsx(Le,{size:d});case"Book":return e.jsx(Te,{size:d});case"Cloud":return e.jsx(_e,{size:d});default:return e.jsx(Ne,{size:d})}}),Qe=u.memo(({dept:o,isActive:d,onClick:m,index:v})=>e.jsxs("div",{onClick:m,style:{animationDelay:`${.1+v*.05}s`},className:`
        glass-card p-5 rounded-2xl cursor-pointer 
        transition-all duration-300 
        hover:border-indigo-400/50 hover:bg-white/80 dark:hover:bg-white/10 hover:-translate-y-1 
        group relative animate-slide-up opacity-0 border border-transparent shadow-sm hover:shadow-lg
        ${d?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-[#f8fafc] dark:ring-offset-[#0f172a]":""}
      `,children:[d&&e.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 bg-indigo-500 rounded-full shadow-[0_0_10px_#6366f1]"}),e.jsx("h3",{className:"font-bold text-slate-800 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-300 transition-colors mb-1",children:o.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 leading-relaxed min-h-[2.5rem] mb-2 line-clamp-2",children:o.description}),e.jsxs("div",{className:"inline-flex items-center gap-1 bg-black/5 dark:bg-white/5 text-slate-400 dark:text-white/40 text-[10px] px-2 py-0.5 rounded-full mt-auto border border-black/5 dark:border-white/5",children:[e.jsx(A,{size:10,className:"text-orange-400"}),o.cards.length," 个应用"]})]})),Ze=u.memo(({card:o,isEditMode:d,isSelected:m,onClick:v,onTogglePin:g,onDelete:$})=>e.jsxs("div",{onClick:v,className:`
        glass-card p-4 rounded-2xl
        flex flex-col items-center text-center h-32 justify-center gap-3 
        transition-all duration-300 
        hover:-translate-y-1 hover:bg-white/90 dark:hover:bg-white/10
        group relative border border-white/60 dark:border-white/5
        shadow-sm hover:shadow-lg
        ${d?"border-indigo-400/50 border-dashed bg-indigo-50 dark:bg-indigo-500/10":""} 
        ${o.isPinned&&!d?"border-orange-200 dark:border-orange-500/30 bg-orange-50 dark:bg-orange-500/10":""}
        `,children:[o.isPinned&&!d&&e.jsx("div",{className:"absolute top-2 right-2 text-orange-400 opacity-80",children:e.jsx(q,{size:12,fill:"currentColor"})}),d&&e.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1 z-50 pointer-events-auto",onClick:f=>f.stopPropagation(),children:[e.jsx("button",{onClick:g,className:`w-8 h-8 flex items-center justify-center glass-card rounded-full ${o.isPinned?"text-orange-400 border-orange-500/50":"text-slate-400 dark:text-white/40"}`,children:o.isPinned?e.jsx(Ie,{size:14}):e.jsx(q,{size:14})}),e.jsx("button",{onClick:$,className:"w-8 h-8 flex items-center justify-center glass-card border-red-500/50 text-red-400 rounded-full",children:e.jsx(O,{size:14})})]}),e.jsx("div",{className:`p-3 rounded-2xl transition-colors ${d?"bg-indigo-100 dark:bg-indigo-500/30 text-indigo-600 dark:text-indigo-200":o.isPinned?"bg-orange-100 dark:bg-orange-500/20 text-orange-500 dark:text-orange-300 group-hover:bg-orange-500 group-hover:text-white":"bg-slate-100/50 dark:bg-white/10 text-slate-600 dark:text-white/70 group-hover:bg-indigo-500 group-hover:text-white"}`,children:e.jsx(W,{name:o.iconName,size:24})}),e.jsxs("div",{className:"w-full",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-white text-sm w-full truncate mb-0.5 group-hover:text-slate-900 dark:group-hover:text-white transition-colors",children:o.title}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-white/40 w-full truncate",children:o.description})]})]})),Xe=({selectedDeptId:o,onSelectDept:d})=>{const[m,v]=u.useState([]),[g,$]=u.useState(!1),[f,K]=u.useState(null),[i,w]=u.useState(null),[x,P]=u.useState(null),[b,_]=u.useState(null),[k,h]=u.useState(null),[T,z]=u.useState(null),[M,X]=u.useState(""),[Y,E]=u.useState(!1),[U,ee]=u.useState(null);u.useEffect(()=>{v(be());const t=fe();K(t)},[]);const j=t=>{v(t),Me(t)},r=m.find(t=>t.id===o),C=m.find(t=>t.isTopLevel),te=m.filter(t=>!t.isTopLevel),B=(()=>{if(!r)return{};const t=[...r.cards].sort((a,n)=>(n.isPinned?1:0)-(a.isPinned?1:0)),s={};return s.通用服务=[],s.业务功能=[],t.forEach(a=>{const n=a.category||"默认分类";s[n]||(s[n]=[]),s[n].push(a)}),s})(),se=Object.keys(B).sort((t,s)=>t==="通用服务"?-1:s==="通用服务"?1:t==="业务功能"?-1:s==="业务功能"?1:t.localeCompare(s)),G=r?Array.from(new Set(r.cards.map(t=>t.category||"业务功能"))).filter(Boolean):[],ae=(t,s)=>{t.preventDefault(),t.stopPropagation(),l("warning"),setTimeout(()=>z(s),10)},re=()=>{if(!o||!T)return;const t=m.map(s=>s.id===o?{...s,cards:s.cards.filter(a=>a.id!==T)}:s);j(t),z(null),l("heavy")},ne=(t,s,a)=>{a.preventDefault(),a.stopPropagation(),l("selection");const n=m.map(c=>c.id===t?{...c,cards:c.cards.map(p=>p.id===s?{...p,isPinned:!p.isPinned}:p)}:c);j(n)},ie=(t,s)=>{if(l("warning"),!confirm("确定删除此公告吗？"))return;l("medium");const a=m.map(n=>n.id===t?{...n,announcements:n.announcements.filter(c=>c.id!==s)}:n);j(a)},le=t=>{if(t.preventDefault(),!o||!(i!=null&&i.title)||!(i!=null&&i.url))return;const s=m.map(a=>{if(a.id===o){let n=[...a.cards];return i.id?n=n.map(c=>c.id===i.id?i:c):n.push({...i,id:Date.now().toString(),category:i.category||"业务功能"}),{...a,cards:n}}return a});j(s),h(null),l("success")},oe=t=>{if(t.preventDefault(),!o||!(x!=null&&x.content))return;const s=m.map(a=>{if(a.id===o){let n=[...a.announcements];const c=new Date().toISOString().split("T")[0],p=!x.id&&f?{publisherName:f.name,publisherPosition:f.position}:{};return x.id?n=n.map(N=>N.id===x.id?{...N,...x}:N):n.unshift({...x,...p,id:Date.now().toString(),date:c}),{...a,announcements:n}}return a});j(s),h(null),l("success")},de=t=>{if(t.preventDefault(),!o||!b)return;const s=m.map(a=>a.id===o?{...a,name:b.name,description:b.desc}:a);j(s),h(null),l("success")},ce=()=>{r&&(l("medium"),_({name:r.name,desc:r.description}),h("deptInfo"))},xe=async()=>{if(r){l("medium"),E(!0);try{const t={type:"dept_config_v1",id:r.id,name:r.name,description:r.description,cards:r.cards,announcements:r.announcements,timestamp:Date.now()},s=JSON.stringify(t),a=await ke(s);X(a),h("share")}catch{alert("生成配置码失败：数据处理错误")}finally{E(!1)}}},he=()=>{if(!M||!r)return;l("selection");const t=document.createElement("a");t.href=M,t.download=`${r.name}_配置彩色码_${new Date().toLocaleDateString()}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},R=()=>{ee(null),h("scan"),l("medium")},me=t=>{try{const s=JSON.parse(t);if(s.type!=="dept_config_v1"||!s.id||!Array.isArray(s.cards))throw new Error("无效的部门配置数据");if(m.some(n=>n.id===s.id)){if(l("warning"),confirm(`检测到部门配置：
${s.name}

包含 ${s.cards.length} 个应用，${s.announcements.length} 条公告。

是否覆盖本地对应部门的数据？`)){const n=m.map(c=>c.id===s.id?{...c,name:s.name||c.name,description:s.description||c.description,cards:s.cards,announcements:s.announcements}:c);return j(n),alert("配置导入成功！"),h(null),l("success"),!0}}else if(l("medium"),confirm(`检测到新部门配置：
${s.name}

包含 ${s.cards.length} 个应用，${s.announcements.length} 条公告。

是否添加该部门到您的工作台？`)){const n={id:s.id,name:s.name,description:s.description||"已导入的部门",isTopLevel:!1,cards:s.cards,announcements:s.announcements},c=[...m,n];return j(c),alert("新部门添加成功！"),h(null),l("success"),!0}}catch{alert("无法识别该配置码，可能是格式错误或版本不兼容"),l("error")}return!1},ue=t=>{var n;const s=(n=t.target.files)==null?void 0:n[0];if(!s)return;l("selection");const a=new FileReader;a.onload=c=>{var N;const p=new Image;p.onload=async()=>{try{const L=await ze(p);me(L)}catch(L){console.error(L),alert("未能识别有效的彩色配置码，请确保图片清晰且未经压缩"),l("error")}},p.src=(N=c.target)==null?void 0:N.result},a.readAsDataURL(s)},ge=["Link","FileText","Monitor","Users","Calendar","Image","Briefcase","Zap","Coffee","Download","Clock","Globe","MessageCircle","Book","Cloud"],pe=t=>{const s=new Date(t),n=Math.abs(new Date().getTime()-s.getTime());return Math.ceil(n/(1e3*60*60*24))<=3};return o?e.jsxs("div",{className:"h-full w-full p-6 md:p-8 overflow-y-auto pb-32 animate-slide-up flex flex-col hide-scrollbar text-slate-800 dark:text-white",children:[e.jsxs("div",{className:"max-w-[1600px] mx-auto w-full flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 shrink-0",children:[e.jsxs("button",{onClick:()=>{d(null),l("light")},className:"flex items-center gap-2 text-slate-500 dark:text-white/60 hover:text-slate-900 dark:hover:text-white transition-colors bg-white/50 dark:bg-white/10 px-4 py-2 rounded-full backdrop-blur-md border border-white/20 shadow-sm active:scale-95",children:[e.jsx(I,{size:18}),e.jsx("span",{className:"text-sm font-bold",children:"返回"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:xe,className:"p-2.5 bg-white/50 dark:bg-white/10 rounded-full backdrop-blur-md border border-white/20 text-slate-700 dark:text-white hover:bg-white/20 active:scale-95 transition-transform",children:e.jsx(De,{size:18})}),e.jsxs("button",{onClick:()=>{$(!g),l("medium")},className:`px-4 py-2 rounded-full text-xs font-bold transition-colors flex items-center gap-1 backdrop-blur-md border border-white/20 active:scale-95 ${g?"bg-indigo-500 text-white":"bg-white/50 dark:bg-white/10 text-slate-700 dark:text-white"}`,children:[g?e.jsx(we,{size:14}):e.jsx($e,{size:14})," ",g?"完成":"管理"]}),e.jsx("button",{onClick:R,className:"p-2.5 bg-white/50 dark:bg-white/10 rounded-full backdrop-blur-md border border-white/20 text-slate-700 dark:text-white hover:bg-white/20 active:scale-95 transition-transform",children:e.jsx(F,{size:18})})]})]}),e.jsxs("div",{className:"mb-8 shrink-0",children:[e.jsxs("h2",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white tracking-tight flex items-center gap-3 text-glow mb-3",children:[e.jsx("div",{className:"p-3 bg-indigo-500/10 dark:bg-white/10 rounded-2xl text-indigo-600 dark:text-indigo-400 border border-indigo-500/20 dark:border-white/10 shadow-sm",children:e.jsx(D,{size:32})}),e.jsxs("div",{className:"flex items-center gap-2",children:[r==null?void 0:r.name,g&&e.jsx("button",{onClick:ce,className:"p-1 text-slate-400 dark:text-white/50 hover:text-slate-800 dark:hover:text-white",children:e.jsx(Ge,{size:18})})]})]}),e.jsx("p",{className:"text-slate-500 dark:text-white/60 text-sm md:text-base leading-relaxed pl-1 max-w-2xl",children:r==null?void 0:r.description})]}),e.jsxs("div",{className:"space-y-8 flex-1 min-h-0",children:[e.jsxs("section",{className:"glass-panel rounded-3xl p-5 animate-slide-up",style:{animationDelay:"0.05s"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-1 border-b border-gray-200 dark:border-white/10 pb-3",children:[e.jsxs("h3",{className:"font-bold text-slate-700 dark:text-white/80 flex items-center gap-2 text-sm uppercase tracking-wide",children:[e.jsx(Ue,{size:16,className:"text-indigo-500 dark:text-indigo-400"})," 部门公告"]}),g&&e.jsx("button",{onClick:()=>{P({content:"",isPinned:!1}),h("announce"),l("medium")},className:"text-xs text-indigo-500 dark:text-indigo-300 font-medium active:scale-95",children:"+ 发布"})]}),e.jsxs("div",{className:"space-y-4",children:[(r==null?void 0:r.announcements.length)===0&&e.jsx("div",{className:"text-sm text-slate-400 dark:text-white/30 italic text-center py-6",children:e.jsx("div",{children:"暂无公告"})}),r==null?void 0:r.announcements.map((t,s)=>e.jsxs("div",{style:{animationDelay:`${.1+s*.05}s`},className:`relative overflow-hidden rounded-xl animate-slide-up opacity-0 transition-all duration-300 ${t.isPinned?"bg-orange-50 dark:bg-orange-500/10 border border-orange-200 dark:border-orange-500/30":"bg-white/40 dark:bg-white/5 border border-white/20 dark:border-white/10"}`,children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${t.isPinned?"bg-orange-500":"bg-indigo-500"}`}),e.jsxs("div",{className:"p-3 pl-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.isPinned&&e.jsxs("span",{className:"bg-orange-100 dark:bg-orange-500/20 text-orange-600 dark:text-orange-300 text-[10px] px-1.5 py-0.5 rounded font-bold flex items-center gap-1 border border-orange-200 dark:border-orange-500/30",children:[e.jsx(q,{size:10,fill:"currentColor"})," 置顶"]}),pe(t.date)&&!t.isPinned&&e.jsx("span",{className:"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded font-bold shadow-lg shadow-red-500/30",children:"NEW"}),t.publisherName&&e.jsx("span",{className:"text-xs font-bold text-slate-500 dark:text-white/70",children:t.publisherName})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-400 dark:text-white/40",children:[e.jsx(Q,{size:10}),t.date]})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-white/90 whitespace-pre-wrap leading-relaxed",children:t.content}),g&&e.jsxs("div",{className:"flex justify-end gap-3 mt-3 pt-3 border-t border-gray-200 dark:border-white/10",children:[e.jsxs("button",{onClick:()=>{P(t),h("announce"),l("medium")},className:"text-indigo-500 dark:text-indigo-300 hover:text-indigo-700 dark:hover:text-white text-xs flex items-center gap-1",children:[e.jsx(He,{size:12})," 编辑"]}),e.jsxs("button",{onClick:()=>ie(r.id,t.id),className:"text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 text-xs flex items-center gap-1",children:[e.jsx(O,{size:12})," 删除"]})]})]})]},t.id))]})]}),e.jsxs("section",{className:"animate-slide-up",style:{animationDelay:"0.2s"},children:[se.map(t=>{const s=B[t];return s.length===0&&!g?null:e.jsxs("div",{className:"mb-6 last:mb-0",children:[e.jsx("div",{className:"flex justify-between items-center mb-3 px-1",children:e.jsxs("h3",{className:"font-bold text-slate-700 dark:text-white/80 flex items-center gap-2 text-sm uppercase tracking-wide",children:[t==="通用服务"?e.jsx(V,{size:16,className:"text-blue-500 dark:text-blue-400"}):e.jsx(A,{size:16,className:"text-indigo-500 dark:text-indigo-400"}),t]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map(a=>e.jsx(Ze,{card:a,isEditMode:g,isSelected:!1,onClick:()=>{g?(w(a),h("card"),l("medium")):a.url==="#settings"?(l("light"),window.location.hash="#settings"):(l("light"),window.open(a.url,"_blank"))},onTogglePin:n=>ne(r.id,a.id,n),onDelete:n=>ae(n,a.id)},a.id))})]},t)}),g&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:()=>{w({title:"",url:"",iconName:"Link",category:"业务功能"}),h("card"),l("medium")},className:"w-full flex flex-col items-center justify-center h-32 glass-card border-dashed border-slate-300 dark:border-white/20 rounded-xl text-slate-400 dark:text-white/40 hover:border-indigo-400 hover:text-indigo-500 dark:hover:text-indigo-300 hover:bg-white/50 dark:hover:bg-white/5 transition-all gap-1 active:scale-95",children:[e.jsx(je,{size:24}),e.jsx("span",{className:"text-xs font-medium",children:"添加新应用"})]})})]})]})]}),k==="deptInfo"&&e.jsx(S,{children:e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"glass-panel rounded-2xl w-full max-w-sm p-6 shadow-2xl animate-fade-in text-slate-800 dark:text-white bg-white/90 dark:bg-black/40",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"编辑部门信息"}),e.jsxs("form",{onSubmit:de,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"部门名称"}),e.jsx("input",{required:!0,value:b==null?void 0:b.name,onChange:t=>_(s=>s?{...s,name:t.target.value}:null),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"部门简介"}),e.jsx("textarea",{required:!0,rows:3,value:b==null?void 0:b.desc,onChange:t=>_(s=>s?{...s,desc:t.target.value}:null),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>h(null),className:"px-4 py-2 text-slate-500 dark:text-white/50 hover:text-slate-800 dark:hover:text-white text-sm",children:"取消"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium shadow-lg hover:bg-indigo-700",children:"保存"})]})]})]})})}),(k==="card"||k==="announce")&&e.jsx(S,{children:e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"glass-panel rounded-2xl w-full max-w-sm p-6 shadow-2xl animate-fade-in overflow-y-auto max-h-[90vh] hide-scrollbar text-slate-800 dark:text-white bg-white/90 dark:bg-black/40",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:k==="card"?"编辑应用卡片":x!=null&&x.id?"编辑公告":"发布新公告"}),k==="card"?e.jsxs("form",{onSubmit:le,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"名称"}),e.jsx("input",{required:!0,value:i==null?void 0:i.title,onChange:t=>w({...i,title:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"例如：宿舍报修"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"描述"}),e.jsx("input",{value:i==null?void 0:i.description,onChange:t=>w({...i,description:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"简短说明功能"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"分类"}),e.jsx("input",{list:"category-options",value:(i==null?void 0:i.category)||"",onChange:t=>w({...i,category:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"例如：业务功能"}),e.jsxs("datalist",{id:"category-options",children:[e.jsx("option",{value:"通用服务"}),e.jsx("option",{value:"业务功能"}),e.jsx("option",{value:"外部链接"})]}),G.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:G.map(t=>e.jsx("button",{type:"button",onClick:()=>{w({...i,category:t}),l("light")},className:`text-[10px] px-2 py-1 rounded-md border transition-colors ${(i==null?void 0:i.category)===t?"bg-indigo-100 dark:bg-indigo-500/30 border-indigo-400 text-indigo-600 dark:text-indigo-200":"bg-black/5 dark:bg-white/5 border-black/10 dark:border-white/10 text-slate-500 dark:text-white/50 hover:bg-black/10 dark:hover:bg-white/10"}`,children:t},t))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"跳转链接"}),e.jsx("input",{required:!0,type:"text",value:i==null?void 0:i.url,onChange:t=>w({...i,url:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"https://..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"选择图标"}),e.jsx("div",{className:"grid grid-cols-6 gap-2 bg-black/5 dark:bg-black/20 p-3 rounded-xl border border-black/5 dark:border-white/10",children:ge.map(t=>e.jsx("button",{type:"button",onClick:()=>{w({...i,iconName:t}),l("light")},className:`p-2 rounded-lg flex items-center justify-center transition-all ${(i==null?void 0:i.iconName)===t?"bg-white text-indigo-600 shadow-md scale-110":"text-slate-400 dark:text-white/40 hover:text-slate-800 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/10"}`,title:t,children:e.jsx(W,{name:t,size:18})},t))})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>h(null),className:"px-4 py-2 text-slate-500 dark:text-white/50 hover:text-slate-800 dark:hover:text-white text-sm",children:"取消"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium shadow-lg hover:bg-indigo-700",children:"保存"})]})]}):e.jsxs("form",{onSubmit:oe,className:"space-y-4",children:[e.jsx("textarea",{required:!0,rows:5,value:x==null?void 0:x.content,onChange:t=>P({...x,content:t.target.value}),className:"w-full glass-input rounded-lg p-3 text-sm focus:outline-none",placeholder:"请输入公告内容..."}),e.jsxs("div",{className:"flex items-center gap-2 bg-black/5 dark:bg-black/20 p-2 rounded-lg border border-black/5 dark:border-white/10",children:[e.jsx("input",{type:"checkbox",id:"pin",checked:x==null?void 0:x.isPinned,onChange:t=>P({...x,isPinned:t.target.checked}),className:"rounded text-indigo-500 focus:ring-indigo-500 bg-transparent border-gray-300 dark:border-white/30"}),e.jsx("label",{htmlFor:"pin",className:"text-sm text-slate-700 dark:text-white/80 font-medium",children:"置顶此公告"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{type:"button",onClick:()=>h(null),className:"px-4 py-2 text-slate-500 dark:text-white/50 hover:text-slate-800 dark:hover:text-white text-sm",children:"取消"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium shadow-lg hover:bg-indigo-700",children:"发布"})]})]})]})})}),k==="share"&&e.jsx(S,{children:e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[999] flex items-center justify-center p-4 backdrop-blur-sm",onClick:()=>h(null),children:e.jsxs("div",{className:"glass-panel rounded-2xl p-8 max-w-sm w-full text-center shadow-2xl animate-fade-in bg-white/95 dark:bg-black/60",onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:r==null?void 0:r.name}),e.jsx("p",{className:"text-slate-500 dark:text-white/50 text-sm mb-6",children:"扫码即可同步该部门的最新配置"}),e.jsx("div",{className:"bg-white p-2 rounded-xl border border-gray-200 dark:border-white/20 shadow-inner inline-block mb-6 overflow-hidden",children:M?e.jsx("img",{src:M,alt:"Dept Config QR",className:"max-h-[40vh] w-auto object-contain",style:{imageRendering:"pixelated"}}):e.jsx("div",{className:"w-48 h-48 flex items-center justify-center text-gray-400 text-sm",children:Y?"正在生成...":"加载中"})}),e.jsxs("p",{className:"text-xs text-slate-400 dark:text-white/30",children:["包含 ",r==null?void 0:r.cards.length," 个卡片和 ",r==null?void 0:r.announcements.length," 条公告"]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsxs("button",{onClick:he,className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-sm active:scale-95 transition-transform flex items-center justify-center gap-2 shadow-lg shadow-indigo-500/30",children:[e.jsx(Z,{size:18})," 保存图片"]}),e.jsx("button",{onClick:()=>h(null),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 hover:bg-gray-200 dark:hover:bg-white/20 text-slate-600 dark:text-white/70 rounded-xl font-medium text-sm active:scale-95 transition-transform",children:"关闭"})]})]})})}),k==="scan"&&e.jsx(S,{children:e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[1000] flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",onClick:()=>h(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 md:p-8 w-full max-w-sm shadow-2xl relative bg-white/95 dark:bg-black/60 text-center flex flex-col items-center",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-50 dark:bg-indigo-500/20 rounded-full flex items-center justify-center mb-4 border border-indigo-100 dark:border-indigo-500/30",children:e.jsx(V,{size:32,className:"text-indigo-600 dark:text-indigo-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"配置同步"}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 leading-relaxed",children:["支持高密度彩色配置码 (CIMBAR)",e.jsx("br",{}),"请上传相册中保存的配置图片"]}),U&&e.jsxs("div",{className:"w-full bg-red-50 dark:bg-red-500/10 border border-red-200 dark:border-red-500/20 rounded-xl p-3 mb-4 text-xs font-bold text-red-600 dark:text-red-300 flex items-center gap-2 justify-center",children:[e.jsx(H,{size:14})," ",U]}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("label",{className:"w-full py-4 bg-indigo-600 text-white rounded-xl font-bold shadow-lg shadow-indigo-500/30 hover:bg-indigo-700 active:scale-95 transition-all flex items-center justify-center gap-2 cursor-pointer",children:[e.jsx(J,{size:20}),e.jsx("span",{children:"从相册选择图片"}),e.jsx("input",{type:"file",accept:"image/*",onChange:ue,className:"hidden"})]}),e.jsx("button",{onClick:()=>h(null),className:"w-full py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white/80 rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-white/20 active:scale-95 transition-all",children:"取消"})]})]})})}),T&&e.jsx(S,{children:e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 backdrop-blur-sm p-6",onClick:()=>z(null),children:e.jsxs("div",{className:"glass-panel w-full max-w-xs rounded-2xl p-6 shadow-2xl animate-slide-up transform transition-all flex flex-col items-center text-center bg-white/95 dark:bg-black/60",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4 text-red-500 animate-bounce",children:e.jsx(H,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"确认删除?"}),e.jsx("p",{className:"text-slate-500 dark:text-white/50 text-sm mb-6",children:"此操作无法撤销，该卡片将被永久移除。"}),e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx("button",{onClick:()=>z(null),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white/70 rounded-xl font-bold active:scale-95 transition-transform hover:bg-gray-200 dark:hover:bg-white/20",children:"取消"}),e.jsx("button",{onClick:re,className:"flex-1 py-3 bg-red-600 text-white rounded-xl font-bold shadow-lg shadow-red-500/30 active:scale-95 transition-transform",children:"删除"})]})]})})})]},o):e.jsxs("div",{className:"p-4 pt-24 pb-32 md:pb-8 animate-fade-in text-slate-800 dark:text-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(D,{className:"text-indigo-600 dark:text-indigo-400",size:24})," 部门导航"]}),e.jsx("button",{onClick:R,className:"p-2.5 bg-white/50 dark:bg-white/10 rounded-full backdrop-blur-md border border-white/20 text-slate-700 dark:text-white hover:bg-white/20 active:scale-95 transition-transform",children:e.jsx(F,{size:18})})]}),C&&e.jsxs("div",{onClick:()=>{d(C.id),l("light")},className:"glass-card bg-gradient-to-br from-indigo-500 to-purple-600 p-6 rounded-3xl mb-8 cursor-pointer transform transition-all duration-300 hover:scale-[1.02] active:scale-95 text-always-white relative overflow-hidden animate-slide-up group border border-indigo-500/30 shadow-xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-20 transform translate-x-4 -translate-y-4 group-hover:scale-110 transition-transform",children:e.jsx(D,{size:100,className:"text-always-white"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-2xl font-bold mb-1 text-always-white text-glow",children:C.name}),e.jsx("p",{className:"text-always-white/70 text-sm mb-4 max-w-[80%]",children:C.description}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 px-3 py-1 rounded-full text-xs font-medium backdrop-blur-sm border border-white/20 text-always-white",children:[e.jsxs("span",{children:[C.cards.length," 个应用"]}),e.jsx(I,{className:"rotate-180 w-3 h-3 text-always-white"})]})]})]}),e.jsx("h4",{className:"text-sm font-bold text-slate-400 dark:text-white/40 uppercase tracking-wider mb-4 px-1 animate-slide-up",style:{animationDelay:"0.1s"},children:"职能部门"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:te.map((t,s)=>e.jsx(Qe,{dept:t,index:s,isActive:(f==null?void 0:f.departmentId)===t.id,onClick:()=>{d(t.id),l("light")}},t.id))})]})};export{Xe as default};
