import{c as P,r as m,g as ze,a as Pe,j as e,A as Z,t as i,C as Se,T as ee,P as Me,X as C,M as te,S as $e,b as De,d as _e,e as Te,L as Le,G as Ee,f as qe,U as Ae,p as Ie,s as Ue}from"./index-L8c2kVrv.js";import{B as _,S as J,a as Be,P as W,C as se,L as X,Z as B,D as I,T as K,I as ae,b as Y,c as Ge,d as Re,M as Fe,e as Oe,F as Qe}from"./zap-BqpAjds9.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],He=P("megaphone",Ve);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Je=P("pen-line",Ze);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],Xe=P("pin-off",We);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],U=P("pin",Ke);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],et=P("square-pen",Ye),v=({children:d})=>Te.createPortal(d,document.body),re=m.memo(({name:d,size:c=20})=>{switch(d){case"FileText":return e.jsx(Qe,{size:c});case"Monitor":return e.jsx(te,{size:c});case"Users":return e.jsx(Ae,{size:c});case"Calendar":return e.jsx(qe,{size:c});case"Image":return e.jsx(ae,{size:c});case"Briefcase":return e.jsx(_,{size:c});case"Zap":return e.jsx(B,{size:c});case"Coffee":return e.jsx(Oe,{size:c});case"Download":return e.jsx(I,{size:c});case"Clock":return e.jsx(se,{size:c});case"Globe":return e.jsx(Ee,{size:c});case"MessageCircle":return e.jsx(Fe,{size:c});case"Book":return e.jsx(Re,{size:c});case"Cloud":return e.jsx(Ge,{size:c});default:return e.jsx(Le,{size:c})}}),tt=m.memo(({dept:d,isActive:c,onClick:u,index:N})=>e.jsxs("div",{onClick:u,style:{animationDelay:`${.1+N*.05}s`},className:`
        glass-card p-5 rounded-2xl cursor-pointer 
        transition-all duration-300 
        hover:border-indigo-400/50 hover:bg-white/80 dark:hover:bg-white/10 hover:-translate-y-1 
        group relative animate-slide-up opacity-0 border border-transparent shadow-sm hover:shadow-lg
        ${c?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-[#f8fafc] dark:ring-offset-[#0f172a]":""}
      `,children:[c&&e.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 bg-indigo-500 rounded-full shadow-[0_0_10px_#6366f1]"}),e.jsx("h3",{className:"font-bold text-slate-800 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-300 transition-colors mb-1",children:d.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 leading-relaxed min-h-[2.5rem] mb-2 line-clamp-2",children:d.description}),e.jsxs("div",{className:"inline-flex items-center gap-1 bg-black/5 dark:bg-white/5 text-slate-400 dark:text-white/40 text-[10px] px-2 py-0.5 rounded-full mt-auto border border-black/5 dark:border-white/5",children:[e.jsx(B,{size:10,className:"text-orange-400"}),d.cards.length," 个应用"]})]})),st=m.memo(({card:d,isEditMode:c,isSelected:u,onClick:N,onTogglePin:g,onDelete:T})=>e.jsxs("div",{onClick:N,className:`
        glass-card p-4 rounded-2xl
        flex flex-col items-center text-center h-32 justify-center gap-3 
        transition-all duration-300 
        hover:-translate-y-1 hover:bg-white/90 dark:hover:bg-white/10
        group relative border border-white/60 dark:border-white/5
        shadow-sm hover:shadow-lg
        ${c?"border-indigo-400/50 border-dashed bg-indigo-50 dark:bg-indigo-500/10":""} 
        ${d.isPinned&&!c?"border-orange-200 dark:border-orange-500/30 bg-orange-50 dark:bg-orange-500/10":""}
        `,children:[d.isPinned&&!c&&e.jsx("div",{className:"absolute top-2 right-2 text-orange-400 opacity-80",children:e.jsx(U,{size:12,fill:"currentColor"})}),c&&e.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1 z-50 pointer-events-auto",onClick:w=>w.stopPropagation(),children:[e.jsx("button",{onClick:g,className:`w-8 h-8 flex items-center justify-center glass-card rounded-full ${d.isPinned?"text-orange-400 border-orange-500/50":"text-slate-400 dark:text-white/40"}`,children:d.isPinned?e.jsx(Xe,{size:14}):e.jsx(U,{size:14})}),e.jsx("button",{onClick:T,className:"w-8 h-8 flex items-center justify-center glass-card border-red-500/50 text-red-400 rounded-full",children:e.jsx(ee,{size:14})})]}),e.jsx("div",{className:`p-3 rounded-2xl transition-colors ${c?"bg-indigo-100 dark:bg-indigo-500/30 text-indigo-600 dark:text-indigo-200":d.isPinned?"bg-orange-100 dark:bg-orange-500/20 text-orange-500 dark:text-orange-300 group-hover:bg-orange-500 group-hover:text-white":"bg-slate-100/50 dark:bg-white/10 text-slate-600 dark:text-white/70 group-hover:bg-indigo-500 group-hover:text-white"}`,children:e.jsx(re,{name:d.iconName,size:24})}),e.jsxs("div",{className:"w-full",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-white text-sm w-full truncate mb-0.5 group-hover:text-slate-900 dark:group-hover:text-white transition-colors",children:d.title}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-white/40 w-full truncate",children:d.description})]})]})),it=({selectedDeptId:d,onSelectDept:c})=>{const[u,N]=m.useState([]),[g,T]=m.useState(!1),[w,ne]=m.useState(null),[l,k]=m.useState(null),[h,S]=m.useState(null),[p,L]=m.useState(null),[G,ie]=m.useState(""),[M,R]=m.useState(""),[f,o]=m.useState(null),[E,$]=m.useState(null),[D,le]=m.useState(""),[oe,F]=m.useState(!1),[O,de]=m.useState(null);m.useEffect(()=>{N(ze());const t=Pe();ne(t)},[]);const j=t=>{N(t),Ue(t)},a=u.find(t=>t.id===d),z=u.find(t=>t.isTopLevel),ce=u.filter(t=>!t.isTopLevel),Q=(()=>{if(!a)return{};const t=[...a.cards].sort((r,n)=>(n.isPinned?1:0)-(r.isPinned?1:0)),s={};return s.通用服务=[],s.业务功能=[],t.forEach(r=>{const n=r.category||"默认分类";s[n]||(s[n]=[]),s[n].push(r)}),s})(),xe=Object.keys(Q).sort((t,s)=>t==="通用服务"?-1:s==="通用服务"?1:t==="业务功能"?-1:s==="业务功能"?1:t.localeCompare(s)),V=a?Array.from(new Set(a.cards.map(t=>t.category||"业务功能"))).filter(Boolean):[],he=(t,s)=>{t.preventDefault(),t.stopPropagation(),i("warning"),setTimeout(()=>$(s),10)},me=()=>{if(!d||!E)return;const t=u.map(s=>s.id===d?{...s,cards:s.cards.filter(r=>r.id!==E)}:s);j(t),$(null),i("heavy")},ue=(t,s,r)=>{r.preventDefault(),r.stopPropagation(),i("selection");const n=u.map(x=>x.id===t?{...x,cards:x.cards.map(b=>b.id===s?{...b,isPinned:!b.isPinned}:b)}:x);j(n)},ge=(t,s)=>{if(i("warning"),!confirm("确定删除此公告吗？"))return;i("medium");const r=u.map(n=>n.id===t?{...n,announcements:n.announcements.filter(x=>x.id!==s)}:n);j(r)},be=t=>{if(t.preventDefault(),!d||!(l!=null&&l.title)||!(l!=null&&l.url))return;const s=u.map(r=>{if(r.id===d){let n=[...r.cards];return l.id?n=n.map(x=>x.id===l.id?l:x):n.push({...l,id:Date.now().toString(),category:l.category||"业务功能"}),{...r,cards:n}}return r});j(s),o(null),i("success")},pe=t=>{if(t.preventDefault(),!d||!(h!=null&&h.content))return;const s=u.map(r=>{if(r.id===d){let n=[...r.announcements];const x=new Date().toISOString().split("T")[0],b=!h.id&&w?{publisherName:w.name,publisherPosition:w.position}:{};return h.id?n=n.map(y=>y.id===h.id?{...y,...h}:y):n.unshift({...h,...b,id:Date.now().toString(),date:x}),{...r,announcements:n}}return r});j(s),o(null),i("success")},fe=t=>{if(t.preventDefault(),!d||!p)return;const s=u.map(r=>r.id===d?{...r,name:p.name,description:p.desc}:r);j(s),o(null),i("success")},we=()=>{a&&(i("medium"),L({name:a.name,desc:a.description}),o("deptInfo"))},ke=async()=>{if(a){i("medium"),F(!0);try{const t={type:"dept_config_v1",id:a.id,name:a.name,description:a.description,cards:a.cards,announcements:a.announcements,timestamp:Date.now()},s=JSON.stringify(t);ie(s);const r=await _e(s);le(r),o("share")}catch{alert("生成配置码失败：数据处理错误")}finally{F(!1)}}},je=()=>{!D||!a||(i("selection"),o("export_selector"))},H=()=>{de(null),o("scan"),i("medium")},q=t=>{try{const s=JSON.parse(t);if(s.type!=="dept_config_v1"||!s.id||!Array.isArray(s.cards))throw new Error("无效的部门配置数据");if(u.some(n=>n.id===s.id)){if(i("warning"),confirm(`检测到部门配置：
${s.name}

包含 ${s.cards.length} 个应用，${s.announcements.length} 条公告。

是否覆盖本地对应部门的数据？`)){const n=u.map(x=>x.id===s.id?{...x,name:s.name||x.name,description:s.description||x.description,cards:s.cards,announcements:s.announcements}:x);return j(n),alert("配置导入成功！"),o(null),i("success"),!0}}else if(i("medium"),confirm(`检测到新部门配置：
${s.name}

包含 ${s.cards.length} 个应用，${s.announcements.length} 条公告。

是否添加该部门到您的工作台？`)){const n={id:s.id,name:s.name,description:s.description||"已导入的部门",isTopLevel:!1,cards:s.cards,announcements:s.announcements},x=[...u,n];return j(x),alert("新部门添加成功！"),o(null),i("success"),!0}}catch{alert("无法识别该配置码，可能是格式错误或版本不兼容"),i("error")}return!1},ve=async()=>{try{const t=await navigator.clipboard.readText();if(!t)throw new Error("Empty");i("success"),q(t)}catch{R(""),o("manual_scan"),i("warning")}},Ne=t=>{var n;const s=(n=t.target.files)==null?void 0:n[0];if(!s)return;i("selection");const r=new FileReader;r.onload=x=>{var y;const b=new Image;b.onload=async()=>{try{const A=await Ie(b);q(A)}catch(A){console.error(A),alert("未能识别有效的彩色配置码，请确保图片清晰且未经压缩"),i("error")}},b.src=(y=x.target)==null?void 0:y.result},r.readAsDataURL(s)},ye=["Link","FileText","Monitor","Users","Calendar","Image","Briefcase","Zap","Coffee","Download","Clock","Globe","MessageCircle","Book","Cloud"],Ce=t=>{const s=new Date(t),n=Math.abs(new Date().getTime()-s.getTime());return Math.ceil(n/(1e3*60*60*24))<=3};return d?e.jsxs("div",{className:"h-full w-full p-6 md:p-8 overflow-y-auto pb-32 animate-slide-up flex flex-col hide-scrollbar text-slate-800 dark:text-white",children:[e.jsxs("div",{className:"max-w-[1600px] mx-auto w-full flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 shrink-0",children:[e.jsxs("button",{onClick:()=>{c(null),i("light")},className:"flex items-center gap-2 text-slate-500 dark:text-white/60 hover:text-slate-900 dark:hover:text-white transition-colors bg-white/50 dark:bg-white/10 px-4 py-2 rounded-full backdrop-blur-md border border-white/20 shadow-sm active:scale-95",children:[e.jsx(Z,{size:18}),e.jsx("span",{className:"text-sm font-bold",children:"返回"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ke,className:"p-2.5 bg-white/50 dark:bg-white/10 rounded-full backdrop-blur-md border border-white/20 text-slate-700 dark:text-white hover:bg-white/20 active:scale-95 transition-transform",children:e.jsx(Be,{size:18})}),e.jsxs("button",{onClick:()=>{T(!g),i("medium")},className:`px-4 py-2 rounded-full text-xs font-bold transition-colors flex items-center gap-1 backdrop-blur-md border border-white/20 active:scale-95 ${g?"bg-indigo-500 text-white":"bg-white/50 dark:bg-white/10 text-slate-700 dark:text-white"}`,children:[g?e.jsx(Se,{size:14}):e.jsx(W,{size:14})," ",g?"完成":"管理"]}),e.jsx("button",{onClick:H,className:"p-2.5 bg-white/50 dark:bg-white/10 rounded-full backdrop-blur-md border border-white/20 text-slate-700 dark:text-white hover:bg-white/20 active:scale-95 transition-transform",children:e.jsx(J,{size:18})})]})]}),e.jsxs("div",{className:"mb-8 shrink-0",children:[e.jsxs("h2",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white tracking-tight flex items-center gap-3 text-glow mb-3",children:[e.jsx("div",{className:"p-3 bg-indigo-500/10 dark:bg-white/10 rounded-2xl text-indigo-600 dark:text-indigo-400 border border-indigo-500/20 dark:border-white/10 shadow-sm",children:e.jsx(_,{size:32})}),e.jsxs("div",{className:"flex items-center gap-2",children:[a==null?void 0:a.name,g&&e.jsx("button",{onClick:we,className:"p-1 text-slate-400 dark:text-white/50 hover:text-slate-800 dark:hover:text-white",children:e.jsx(Je,{size:18})})]})]}),e.jsx("p",{className:"text-slate-500 dark:text-white/60 text-sm md:text-base leading-relaxed pl-1 max-w-2xl",children:a==null?void 0:a.description})]}),e.jsxs("div",{className:"space-y-8 flex-1 min-h-0",children:[e.jsxs("section",{className:"glass-panel rounded-3xl p-5 animate-slide-up",style:{animationDelay:"0.05s"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-1 border-b border-gray-200 dark:border-white/10 pb-3",children:[e.jsxs("h3",{className:"font-bold text-slate-700 dark:text-white/80 flex items-center gap-2 text-sm uppercase tracking-wide",children:[e.jsx(He,{size:16,className:"text-indigo-500 dark:text-indigo-400"})," 部门公告"]}),g&&e.jsx("button",{onClick:()=>{S({content:"",isPinned:!1}),o("announce"),i("medium")},className:"text-xs text-indigo-500 dark:text-indigo-300 font-medium active:scale-95",children:"+ 发布"})]}),e.jsxs("div",{className:"space-y-4",children:[(a==null?void 0:a.announcements.length)===0&&e.jsx("div",{className:"text-sm text-slate-400 dark:text-white/30 italic text-center py-6",children:e.jsx("div",{children:"暂无公告"})}),a==null?void 0:a.announcements.map((t,s)=>e.jsxs("div",{style:{animationDelay:`${.1+s*.05}s`},className:`relative overflow-hidden rounded-xl animate-slide-up opacity-0 transition-all duration-300 ${t.isPinned?"bg-orange-50 dark:bg-orange-500/10 border border-orange-200 dark:border-orange-500/30":"bg-white/40 dark:bg-white/5 border border-white/20 dark:border-white/10"}`,children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${t.isPinned?"bg-orange-500":"bg-indigo-500"}`}),e.jsxs("div",{className:"p-3 pl-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.isPinned&&e.jsxs("span",{className:"bg-orange-100 dark:bg-orange-500/20 text-orange-600 dark:text-orange-300 text-[10px] px-1.5 py-0.5 rounded font-bold flex items-center gap-1 border border-orange-200 dark:border-orange-500/30",children:[e.jsx(U,{size:10,fill:"currentColor"})," 置顶"]}),Ce(t.date)&&!t.isPinned&&e.jsx("span",{className:"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded font-bold shadow-lg shadow-red-500/30",children:"NEW"}),t.publisherName&&e.jsx("span",{className:"text-xs font-bold text-slate-500 dark:text-white/70",children:t.publisherName})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-400 dark:text-white/40",children:[e.jsx(se,{size:10}),t.date]})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-white/90 whitespace-pre-wrap leading-relaxed",children:t.content}),g&&e.jsxs("div",{className:"flex justify-end gap-3 mt-3 pt-3 border-t border-gray-200 dark:border-white/10",children:[e.jsxs("button",{onClick:()=>{S(t),o("announce"),i("medium")},className:"text-indigo-500 dark:text-indigo-300 hover:text-indigo-700 dark:hover:text-white text-xs flex items-center gap-1",children:[e.jsx(et,{size:12})," 编辑"]}),e.jsxs("button",{onClick:()=>ge(a.id,t.id),className:"text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 text-xs flex items-center gap-1",children:[e.jsx(ee,{size:12})," 删除"]})]})]})]},t.id))]})]}),e.jsxs("section",{className:"animate-slide-up",style:{animationDelay:"0.2s"},children:[xe.map(t=>{const s=Q[t];return s.length===0&&!g?null:e.jsxs("div",{className:"mb-6 last:mb-0",children:[e.jsx("div",{className:"flex justify-between items-center mb-3 px-1",children:e.jsxs("h3",{className:"font-bold text-slate-700 dark:text-white/80 flex items-center gap-2 text-sm uppercase tracking-wide",children:[t==="通用服务"?e.jsx(X,{size:16,className:"text-blue-500 dark:text-blue-400"}):e.jsx(B,{size:16,className:"text-indigo-500 dark:text-indigo-400"}),t]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map(r=>e.jsx(st,{card:r,isEditMode:g,isSelected:!1,onClick:()=>{g?(k(r),o("card"),i("medium")):r.url==="#settings"?(i("light"),window.location.hash="#settings"):(i("light"),window.open(r.url,"_blank"))},onTogglePin:n=>ue(a.id,r.id,n),onDelete:n=>he(n,r.id)},r.id))})]},t)}),g&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:()=>{k({title:"",url:"",iconName:"Link",category:"业务功能"}),o("card"),i("medium")},className:"w-full flex flex-col items-center justify-center h-32 glass-card border-dashed border-slate-300 dark:border-white/20 rounded-xl text-slate-400 dark:text-white/40 hover:border-indigo-400 hover:text-indigo-500 dark:hover:text-indigo-300 hover:bg-white/50 dark:hover:bg-white/5 transition-all gap-1 active:scale-95",children:[e.jsx(Me,{size:24}),e.jsx("span",{className:"text-xs font-medium",children:"添加新应用"})]})})]})]})]}),f==="deptInfo"&&e.jsx(v,{children:e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999] flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",onClick:()=>o(null),children:e.jsxs("div",{className:"glass-panel rounded-2xl w-full max-w-sm p-6 shadow-2xl text-slate-800 dark:text-white bg-white/90 dark:bg-black/40 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>o(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(C,{size:20})}),e.jsx("h3",{className:"text-lg font-bold mb-4",children:"编辑部门信息"}),e.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"部门名称"}),e.jsx("input",{required:!0,value:p==null?void 0:p.name,onChange:t=>L(s=>s?{...s,name:t.target.value}:null),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"部门简介"}),e.jsx("textarea",{required:!0,rows:3,value:p==null?void 0:p.desc,onChange:t=>L(s=>s?{...s,desc:t.target.value}:null),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>o(null),className:"px-4 py-2 text-slate-500 dark:text-white/50 hover:text-slate-800 dark:hover:text-white text-sm",children:"取消"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium shadow-lg hover:bg-indigo-700",children:"保存"})]})]})]})})}),(f==="card"||f==="announce")&&e.jsx(v,{children:e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[999] flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",onClick:()=>o(null),children:e.jsxs("div",{className:"glass-panel rounded-2xl w-full max-w-sm p-6 shadow-2xl overflow-y-auto max-h-[90vh] hide-scrollbar text-slate-800 dark:text-white bg-white/90 dark:bg-black/40 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>o(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(C,{size:20})}),e.jsx("h3",{className:"text-lg font-bold mb-4",children:f==="card"?"编辑应用卡片":h!=null&&h.id?"编辑公告":"发布新公告"}),f==="card"?e.jsxs("form",{onSubmit:be,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"名称"}),e.jsx("input",{required:!0,value:l==null?void 0:l.title,onChange:t=>k({...l,title:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"例如：宿舍报修"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"描述"}),e.jsx("input",{value:l==null?void 0:l.description,onChange:t=>k({...l,description:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"简短说明功能"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"分类"}),e.jsx("input",{list:"category-options",value:(l==null?void 0:l.category)||"",onChange:t=>k({...l,category:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"例如：业务功能"}),e.jsxs("datalist",{id:"category-options",children:[e.jsx("option",{value:"通用服务"}),e.jsx("option",{value:"业务功能"}),e.jsx("option",{value:"外部链接"})]}),V.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:V.map(t=>e.jsx("button",{type:"button",onClick:()=>{k({...l,category:t}),i("light")},className:`text-[10px] px-2 py-1 rounded-md border transition-colors ${(l==null?void 0:l.category)===t?"bg-indigo-100 dark:bg-indigo-500/30 border-indigo-400 text-indigo-600 dark:text-indigo-200":"bg-black/5 dark:bg-white/5 border-black/10 dark:border-white/10 text-slate-500 dark:text-white/50 hover:bg-black/10 dark:hover:bg-white/10"}`,children:t},t))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"跳转链接"}),e.jsx("input",{required:!0,type:"text",value:l==null?void 0:l.url,onChange:t=>k({...l,url:t.target.value}),className:"w-full glass-input rounded-lg p-2.5 text-sm focus:outline-none",placeholder:"https://..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-slate-500 dark:text-white/50",children:"选择图标"}),e.jsx("div",{className:"grid grid-cols-6 gap-2 bg-black/5 dark:bg-black/20 p-3 rounded-xl border border-black/5 dark:border-white/10",children:ye.map(t=>e.jsx("button",{type:"button",onClick:()=>{k({...l,iconName:t}),i("light")},className:`p-2 rounded-lg flex items-center justify-center transition-all ${(l==null?void 0:l.iconName)===t?"bg-white text-indigo-600 shadow-md scale-110":"text-slate-400 dark:text-white/40 hover:text-slate-800 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/10"}`,title:t,children:e.jsx(re,{name:t,size:18})},t))})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>o(null),className:"px-4 py-2 text-slate-500 dark:text-white/50 hover:text-slate-800 dark:hover:text-white text-sm",children:"取消"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium shadow-lg hover:bg-indigo-700",children:"保存"})]})]}):e.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[e.jsx("textarea",{required:!0,rows:5,value:h==null?void 0:h.content,onChange:t=>S({...h,content:t.target.value}),className:"w-full glass-input rounded-lg p-3 text-sm focus:outline-none",placeholder:"请输入公告内容..."}),e.jsxs("div",{className:"flex items-center gap-2 bg-black/5 dark:bg-black/20 p-2 rounded-lg border border-black/5 dark:border-white/10",children:[e.jsx("input",{type:"checkbox",id:"pin",checked:h==null?void 0:h.isPinned,onChange:t=>S({...h,isPinned:t.target.checked}),className:"rounded text-indigo-500 focus:ring-indigo-500 bg-transparent border-gray-300 dark:border-white/30"}),e.jsx("label",{htmlFor:"pin",className:"text-sm text-slate-700 dark:text-white/80 font-medium",children:"置顶此公告"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{type:"button",onClick:()=>o(null),className:"px-4 py-2 text-slate-500 dark:text-white/50 hover:text-slate-800 dark:hover:text-white text-sm",children:"取消"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium shadow-lg hover:bg-indigo-700",children:"发布"})]})]})]})})}),f==="share"&&e.jsx(v,{children:e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[999] flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",onClick:()=>o(null),children:e.jsxs("div",{className:"glass-panel rounded-2xl p-8 max-w-sm w-full text-center shadow-2xl bg-white/95 dark:bg-black/60 relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>o(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(C,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:a==null?void 0:a.name}),e.jsx("p",{className:"text-slate-500 dark:text-white/50 text-sm mb-6",children:"扫码即可同步该部门的最新配置"}),e.jsx("div",{className:"bg-white p-2 rounded-xl border border-gray-200 dark:border-white/20 shadow-inner inline-block mb-6 overflow-hidden",children:D?e.jsx("img",{src:D,alt:"Dept Config QR",className:"max-h-[40vh] w-auto object-contain",style:{imageRendering:"pixelated"}}):e.jsx("div",{className:"w-48 h-48 flex items-center justify-center text-gray-400 text-sm",children:oe?"正在生成...":"加载中"})}),e.jsxs("p",{className:"text-xs text-slate-400 dark:text-white/30",children:["包含 ",a==null?void 0:a.cards.length," 个卡片和 ",a==null?void 0:a.announcements.length," 条公告"]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsxs("button",{onClick:je,className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-sm active:scale-95 transition-transform flex items-center justify-center gap-2 shadow-lg shadow-indigo-500/30",children:[e.jsx(I,{size:18})," 保存图片"]}),e.jsx("button",{onClick:()=>o(null),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 hover:bg-gray-200 dark:hover:bg-white/20 text-slate-600 dark:text-white/70 rounded-xl font-medium text-sm active:scale-95 transition-transform",children:"关闭"})]})]})})}),f==="scan"&&e.jsx(v,{children:e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[1000] flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",onClick:()=>o(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 md:p-8 w-full max-w-sm shadow-2xl relative bg-white/95 dark:bg-black/60 text-center flex flex-col items-center",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>o(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(C,{size:20})}),e.jsx("div",{className:"w-16 h-16 bg-indigo-50 dark:bg-indigo-500/20 rounded-full flex items-center justify-center mb-4 border border-indigo-100 dark:border-indigo-500/30",children:e.jsx(X,{size:32,className:"text-indigo-600 dark:text-indigo-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"配置同步"}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 leading-relaxed",children:["支持高密度彩色配置码 (CIMBAR)",e.jsx("br",{}),"请上传相册中保存的配置图片"]}),O&&e.jsxs("div",{className:"w-full bg-red-50 dark:bg-red-500/10 border border-red-200 dark:border-red-500/20 rounded-xl p-3 mb-4 text-xs font-bold text-red-600 dark:text-red-300 flex items-center gap-2 justify-center",children:[e.jsx(K,{size:14})," ",O]}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("label",{className:"w-full py-4 bg-indigo-600 text-white rounded-xl font-bold shadow-lg shadow-indigo-500/30 hover:bg-indigo-700 active:scale-95 transition-all flex items-center justify-center gap-2 cursor-pointer",children:[e.jsx(ae,{size:20}),e.jsx("span",{children:"从相册选择图片"}),e.jsx("input",{type:"file",accept:"image/*",onChange:Ne,className:"hidden"})]}),e.jsxs("button",{onClick:ve,className:"w-full py-4 bg-white dark:bg-white/10 border border-indigo-200 dark:border-white/20 text-indigo-600 dark:text-white rounded-xl font-bold hover:bg-indigo-50 dark:hover:bg-white/20 active:scale-95 transition-all flex items-center justify-center gap-2",children:[e.jsx(Y,{size:20}),e.jsx("span",{children:"粘贴文本配置"})]}),e.jsx("button",{onClick:()=>o(null),className:"w-full py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white/80 rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-white/20 active:scale-95 transition-all",children:"取消"})]})]})})}),E&&e.jsx(v,{children:e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/80 backdrop-blur-sm p-6",onClick:()=>$(null),children:e.jsxs("div",{className:"glass-panel w-full max-w-xs rounded-2xl p-6 shadow-2xl animate-slide-up transform transition-all flex flex-col items-center text-center bg-white/95 dark:bg-black/60",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4 text-red-500 animate-bounce",children:e.jsx(K,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"确认删除?"}),e.jsx("p",{className:"text-slate-500 dark:text-white/50 text-sm mb-6",children:"此操作无法撤销，该卡片将被永久移除。"}),e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx("button",{onClick:()=>$(null),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white/70 rounded-xl font-bold active:scale-95 transition-transform hover:bg-gray-200 dark:hover:bg-white/20",children:"取消"}),e.jsx("button",{onClick:me,className:"flex-1 py-3 bg-red-600 text-white rounded-xl font-bold shadow-lg shadow-red-500/30 active:scale-95 transition-transform",children:"删除"})]})]})})}),f==="export_selector"&&e.jsx(v,{children:e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>o(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm bg-white/95 dark:bg-black/60 shadow-2xl relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>o(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(C,{size:20})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2 text-center",children:"选择导出方式"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 text-center",children:"请根据当前设备环境选择最合适的传输方式"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-indigo-50 dark:bg-indigo-500/10 border border-indigo-100 dark:border-indigo-500/20 hover:bg-indigo-100 dark:hover:bg-indigo-500/20 transition-colors cursor-pointer group",onClick:()=>{const t=document.createElement("a");t.href=D,t.download=`${a==null?void 0:a.name}_配置彩色码_${new Date().toLocaleDateString()}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t),i("success")},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-500 text-white flex items-center justify-center shrink-0 shadow-lg shadow-indigo-500/30 group-hover:scale-110 transition-transform",children:e.jsx(te,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-base mb-1",children:"电脑端导出"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/60",children:"下载配置码图片 (PNG)"})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white dark:bg-white/10 flex items-center justify-center text-slate-400",children:e.jsx(I,{size:16})})]})}),e.jsx("div",{className:"p-4 rounded-2xl bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 hover:border-indigo-500 dark:hover:border-indigo-400 transition-colors cursor-pointer group",onClick:()=>{},children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"flex items-center gap-4 list-none cursor-pointer",onClick:()=>i("selection"),children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500 text-white flex items-center justify-center shrink-0 shadow-lg shadow-green-500/30 group-hover:scale-110 transition-transform",children:e.jsx($e,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-base mb-1",children:"移动端导出"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/60",children:"复制文本配置"})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white dark:bg-white/10 flex items-center justify-center text-slate-400 group-open:rotate-90 transition-transform",children:e.jsx(De,{size:16})})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-white/10 animate-fade-in",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 mb-2",children:"请复制以下内容发送到移动设备："}),e.jsx("textarea",{readOnly:!0,value:G,className:"w-full h-32 p-3 glass-input rounded-xl text-xs font-mono mb-3 focus:outline-none resize-none",onClick:t=>t.target.select()}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(G),i("success"),alert("已复制到剪贴板")},className:"w-full py-2 bg-green-500 hover:bg-green-600 text-white rounded-xl font-bold text-sm shadow-lg shadow-green-500/30 active:scale-95 transition-all flex items-center justify-center gap-2",children:[e.jsx(Y,{size:16})," 复制文本"]})]})]})})]}),e.jsx("button",{onClick:()=>o(null),className:"w-full mt-6 py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-white/20 transition-colors",children:"关闭"})]})})}),f==="manual_scan"&&e.jsx(v,{children:e.jsx("div",{className:"fixed inset-0 z-[1000] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>o(null),children:e.jsxs("div",{className:"glass-panel rounded-3xl p-6 w-full max-w-sm bg-white/95 dark:bg-black/60 shadow-2xl relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>o(null),className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-95",children:e.jsx(C,{size:20})}),e.jsx("div",{className:"w-16 h-16 bg-indigo-50 dark:bg-indigo-500/20 rounded-full flex items-center justify-center text-indigo-500 dark:text-indigo-400 mx-auto mb-4 border border-indigo-100 dark:border-indigo-500/30",children:e.jsx(W,{size:32})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2 text-center",children:"手动输入配置"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 text-center",children:"无法读取剪贴板，请长按下方输入框粘贴"}),e.jsx("textarea",{value:M,onChange:t=>R(t.target.value),placeholder:"在此处粘贴配置数据...",className:"w-full h-40 p-4 glass-input rounded-xl text-xs font-mono mb-4 focus:outline-none resize-none",autoFocus:!0}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>o("scan"),className:"flex-1 py-3 bg-gray-100 dark:bg-white/10 text-slate-600 dark:text-white rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-white/20 transition-colors",children:"取消"}),e.jsx("button",{onClick:()=>{M&&q(M)&&o(null)},disabled:!M,className:"flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"确认导入"})]})]})})})]},d):e.jsxs("div",{className:"p-4 pt-24 pb-32 md:pb-8 animate-fade-in text-slate-800 dark:text-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(_,{className:"text-indigo-600 dark:text-indigo-400",size:24})," 部门导航"]}),e.jsx("button",{onClick:H,className:"p-2.5 bg-white/50 dark:bg-white/10 rounded-full backdrop-blur-md border border-white/20 text-slate-700 dark:text-white hover:bg-white/20 active:scale-95 transition-transform",children:e.jsx(J,{size:18})})]}),z&&e.jsxs("div",{onClick:()=>{c(z.id),i("light")},className:"glass-card bg-gradient-to-br from-indigo-500 to-purple-600 p-6 rounded-3xl mb-8 cursor-pointer transform transition-all duration-300 hover:scale-[1.02] active:scale-95 text-always-white relative overflow-hidden animate-slide-up group border border-indigo-500/30 shadow-xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-20 transform translate-x-4 -translate-y-4 group-hover:scale-110 transition-transform",children:e.jsx(_,{size:100,className:"text-always-white"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-2xl font-bold mb-1 text-always-white text-glow",children:z.name}),e.jsx("p",{className:"text-always-white/70 text-sm mb-4 max-w-[80%]",children:z.description}),e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 px-3 py-1 rounded-full text-xs font-medium backdrop-blur-sm border border-white/20 text-always-white",children:[e.jsxs("span",{children:[z.cards.length," 个应用"]}),e.jsx(Z,{className:"rotate-180 w-3 h-3 text-always-white"})]})]})]}),e.jsx("h4",{className:"text-sm font-bold text-slate-400 dark:text-white/40 uppercase tracking-wider mb-4 px-1 animate-slide-up",style:{animationDelay:"0.1s"},children:"职能部门"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:ce.map((t,s)=>e.jsx(tt,{dept:t,index:s,isActive:(w==null?void 0:w.departmentId)===t.id,onClick:()=>{c(t.id),i("light")}},t.id))})]})};export{it as default};
